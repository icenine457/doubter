<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Doubter - v1.2.0</title><meta name="description" content="Documentation for Doubter - v1.2.0"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">Doubter - v1.2.0</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>Doubter - v1.2.0</h2></div>
<div class="tsd-panel tsd-typography"><p align="center">
  <a href="#readme">
    <img src="./images/logo.png" alt="Doubter" width="400"/>
  </a>
</p>

<p>No-hassle runtime validation and transformation library.</p>
<ul>
<li>TypeScript first;</li>
<li>Zero dependencies;</li>
<li>Sync and async validation and transformation flows;</li>
<li><a href="#type-coercion">Human-oriented type coercion;</a></li>
<li><a href="#performance">High performance and low memory consumption;</a></li>
<li><a href="https://bundlephobia.com/result?p=doubter">Just 10 kB gzipped</a> and tree-shakable;</li>
</ul>
<p>🔥&ensp;<a href="https://codesandbox.io/s/doubter-example-y5kec4"><strong>Try Doubter on CodeSandbox</strong></a></p>
<pre><code class="language-shell"><span class="hl-0">npm </span><span class="hl-1">install</span><span class="hl-0"> </span><span class="hl-1">--save-prod</span><span class="hl-0"> </span><span class="hl-1">doubter</span>
</code></pre>
<p><strong>Core features</strong></p>
<ul>
<li><a href="#basics">Basics</a></li>
<li><a href="#shapes">Shapes</a></li>
<li><a href="#parsing-and-trying">Parsing and trying</a></li>
<li><a href="#validation-errors">Validation errors</a></li>
<li><a href="#checks">Checks</a></li>
<li><a href="#refinements">Refinements</a></li>
<li><a href="#transformations">Transformations</a></li>
<li><a href="#parsing-context">Parsing context</a></li>
<li><a href="#shape-piping">Shape piping</a></li>
<li><a href="#exclude">Exclude</a></li>
<li><a href="#include">Include</a></li>
<li><a href="#replace">Replace</a></li>
<li><a href="#optional-and-non-optional">Optional and non-optional</a></li>
<li><a href="#nullable-and-nullish">Nullable and nullish</a></li>
<li><a href="#deep-partial">Deep partial</a></li>
<li><a href="#fallback-value">Fallback value</a></li>
<li><a href="#branded-types">Branded types</a></li>
<li><a href="#sub-shape-at-key">Sub-shape at key</a></li>
<li><a href="#localization">Localization</a></li>
<li><a href="#integrations">Integrations</a></li>
<li><a href="#guarded-functions">Guarded functions</a></li>
</ul>
<p><a href="#type-coercion"><strong>Type coercion</strong></a></p>
<ul>
<li><a href="#coerce-to-string">Coerce to string</a></li>
<li><a href="#coerce-to-number">Coerce to number</a></li>
<li><a href="#coerce-to-boolean">Coerce to boolean</a></li>
<li><a href="#coerce-to-bigint">Coerce to bigint</a></li>
<li><a href="#coerce-to-enum">Coerce to enum</a></li>
<li><a href="#coerce-to-array">Coerce to array</a></li>
<li><a href="#coerce-to-date">Coerce to <code>Date</code></a></li>
<li><a href="#coerce-to-promise">Coerce to <code>Promise</code></a></li>
<li><a href="#coerce-to-map">Coerce to <code>Map</code></a></li>
<li><a href="#coerce-to-set">Coerce to <code>Set</code></a></li>
</ul>
<p><a href="#cookbook"><strong>Cookbook</strong></a></p>
<ul>
<li><a href="#rename-object-keys">Rename object keys</a></li>
<li><a href="#type-safe-url-query-params">Type-safe URL query params</a></li>
</ul>
<p><a href="#performance"><strong>Performance</strong></a></p>
<p><a href="#data-types"><strong>Data types</strong></a></p>
<ul>
<li><p>Strings<br>
<a href="#string"><code>string</code></a></p>
</li>
<li><p>Numbers<br>
<a href="#number"><code>number</code></a>
<a href="#integer"><code>integer</code></a>
<a href="#integer"><code>int</code></a>
<a href="#finite"><code>finite</code></a>
<a href="#nan"><code>nan</code></a>
<a href="#bigint"><code>bigint</code></a></p>
</li>
<li><p>Booleans<br>
<a href="#boolean"><code>boolean</code></a>
<a href="#boolean"><code>bool</code></a></p>
</li>
<li><p>Symbols<br>
<a href="#symbol"><code>symbol</code></a></p>
</li>
<li><p>Literal values<br>
<a href="#enum"><code>enum</code></a>
<a href="#const"><code>const</code></a>
<a href="#null"><code>null</code></a>
<a href="#undefined"><code>undefined</code></a>
<a href="#void"><code>void</code></a></p>
</li>
<li><p>Objects<br>
<a href="#object"><code>object</code></a>
<a href="#record"><code>record</code></a>
<a href="#instanceof"><code>instanceOf</code></a></p>
</li>
<li><p>Collections<br>
<a href="#array"><code>array</code></a>
<a href="#tuple"><code>tuple</code></a>
<a href="#set"><code>set</code></a>
<a href="#map"><code>map</code></a></p>
</li>
<li><p>Dates<br>
<a href="#date"><code>date</code></a></p>
</li>
<li><p>Promises<br>
<a href="#promise"><code>promise</code></a></p>
</li>
<li><p>Shape composition<br>
<a href="#union"><code>union</code></a>
<a href="#union"><code>or</code></a>
<a href="#intersection"><code>intersection</code></a>
<a href="#intersection"><code>and</code></a></p>
</li>
<li><p>Unconstrained values<br>
<a href="#any"><code>any</code></a>
<a href="#unknown"><code>unknown</code></a>
<a href="#never"><code>never</code></a></p>
</li>
<li><p>Other<br>
<a href="#transform"><code>transform</code></a>
<a href="#lazy"><code>lazy</code></a>
<a href="#json"><code>json</code></a></p>
</li>
</ul>

<a href="#basics" id="basics" style="color: inherit; text-decoration: none;">
  <h1>Basics</h1>
</a>
<p>Let&#39;s create a simple shape of a user object:</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-0"> </span><span class="hl-3">*</span><span class="hl-0"> </span><span class="hl-2">as</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0"> </span><span class="hl-2">from</span><span class="hl-0"> </span><span class="hl-1">&#39;doubter&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">userShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">int</span><span class="hl-0">().</span><span class="hl-6">gte</span><span class="hl-0">(</span><span class="hl-7">18</span><span class="hl-0">).</span><span class="hl-6">lt</span><span class="hl-0">(</span><span class="hl-7">100</span><span class="hl-0">)</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ name: string, age: number }&gt;</span>
</code></pre>
<p>This shape can be used to validate a value:</p>
<pre><code class="language-ts"><span class="hl-4">userShape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-1">&#39;John Belushi&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-7">30</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ { name: &#39;John Belushi&#39;, age: 30 }</span>
</code></pre>
<p>If an incorrect value is provided, a validation error is thrown:</p>
<pre><code class="language-ts"><span class="hl-4">userShape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-1">&#39;Peter Parker&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-7">17</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ❌ ValidationError: numberGreaterThanOrEqual at /age: Must be greater than or equal to 18</span>
</code></pre>
<p>Infer user type from the shape:</p>
<pre><code class="language-ts"><span class="hl-3">type</span><span class="hl-0"> </span><span class="hl-9">User</span><span class="hl-0"> = </span><span class="hl-3">typeof</span><span class="hl-0"> </span><span class="hl-4">userShape</span><span class="hl-0">[</span><span class="hl-1">&#39;output&#39;</span><span class="hl-0">];</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">user</span><span class="hl-0">: </span><span class="hl-9">User</span><span class="hl-0"> = {</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-1">&#39;Dan Aykroyd&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-7">27</span><br/><span class="hl-0">};</span>
</code></pre>

<a href="#shapes" id="shapes" style="color: inherit; text-decoration: none;">
  <h1>Shapes</h1>
</a>
<p>Shapes are validation and transformation pipelines that have an input and an output. Here&#39;s a shape that restricts an
input to a string and produces a string as an output:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;string&gt;</span>
</code></pre>
<p>Shapes can have different input and output types. For example, the shape below allows strings and
<a href="#optional-and-non-optional">replaces <code>undefined</code></a> input values with a default value &quot;Mars&quot;:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">optional</span><span class="hl-0">(</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string | undefined, string&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;Pluto&#39;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">undefined</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;Mars&#39;</span>
</code></pre>
<p>Infer the input and output types of the shape:</p>
<pre><code class="language-ts"><span class="hl-3">type</span><span class="hl-0"> </span><span class="hl-9">ShapeInput</span><span class="hl-0"> = </span><span class="hl-3">typeof</span><span class="hl-0"> </span><span class="hl-4">shape</span><span class="hl-0">[</span><span class="hl-1">&#39;input&#39;</span><span class="hl-0">];</span><br/><span class="hl-8">// ⮕ string | undefined</span><br/><br/><span class="hl-3">type</span><span class="hl-0"> </span><span class="hl-9">ShapeOutput</span><span class="hl-0"> = </span><span class="hl-3">typeof</span><span class="hl-0"> </span><span class="hl-4">shape</span><span class="hl-0">[</span><span class="hl-1">&#39;output&#39;</span><span class="hl-0">];</span><br/><span class="hl-8">// ⮕ string</span>
</code></pre>

<a href="#async-shapes" id="async-shapes" style="color: inherit; text-decoration: none;">
  <h2>Async shapes</h2>
</a>
<p><a href="#transformations">Transformations</a> and reliance on <a href="#promise">promise shapes</a> make your shapes async.</p>
<p>Here&#39;s a shape of a promise that is expected to be fulfilled with a number:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">asyncShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">promise</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">());</span><br/><span class="hl-8">// ⮕ Shape&lt;Promise&lt;number&gt;&gt;</span>
</code></pre>
<p>You can check that the shape is async:</p>
<pre><code class="language-ts"><span class="hl-4">asyncShape</span><span class="hl-0">.</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-8">// ⮕ true</span>
</code></pre>
<p>Async shapes don&#39;t support synchronous <code>parse</code> method, and would throw an error if it is called:</p>
<pre><code class="language-ts"><span class="hl-4">asyncShape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-9">Promise</span><span class="hl-0">.</span><span class="hl-6">resolve</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">));</span><br/><span class="hl-8">// ❌ Error: Shape is async</span>
</code></pre>
<p>Use <code>parseAsync</code> with async shapes instead:</p>
<pre><code class="language-ts"><span class="hl-4">asyncShape</span><span class="hl-0">.</span><span class="hl-6">parseAsync</span><span class="hl-0">(</span><span class="hl-9">Promise</span><span class="hl-0">.</span><span class="hl-6">resolve</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">));</span><br/><span class="hl-8">// ⮕ Promise&lt;42&gt;</span>
</code></pre>
<p>Any shape that relies on an async shape becomes async as well:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">objectShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">asyncShape</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: Promise&lt;number&gt; }&gt;</span><br/><br/><span class="hl-4">objectShape</span><span class="hl-0">.</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-8">// ⮕ true</span>
</code></pre>

<a href="#parsing-and-trying" id="parsing-and-trying" style="color: inherit; text-decoration: none;">
  <h1>Parsing and trying</h1>
</a>
<p>Each shape can parse input values and there are several methods for that purpose.</p>
<p>Methods listed in this section can be safely detached from the shape instance:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> { </span><span class="hl-5">parseOrDefault</span><span class="hl-0"> } = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">();</span><br/><br/><span class="hl-6">parseOrDefault</span><span class="hl-0">(</span><span class="hl-1">&#39;Jill&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;Jill&#39;</span><br/><br/><span class="hl-6">parseOrDefault</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ undefined</span>
</code></pre>

<a href="#parse" id="parse" style="color: inherit; text-decoration: none;">
  <h2><code>parse</code></h2>
</a>
<p>You&#39;re already familiar with <code>parse</code> that takes an input value and returns an output value, or throws a validation error
is parsing fails:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 42</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a number</span>
</code></pre>
<p>Use <code>parseAsync</code> with <a href="#async-shapes">async shapes</a>. It has the same semantics and returns a promise.</p>

<a href="#parseordefault" id="parseordefault" style="color: inherit; text-decoration: none;">
  <h2><code>parseOrDefault</code></h2>
</a>
<p>Sometimes you don&#39;t care about validation errors, and want a default value to be returned if things go south:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parseOrDefault</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 42</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parseOrDefault</span><span class="hl-0">(</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ undefined</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parseOrDefault</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">, </span><span class="hl-7">5.3361</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 5.3361</span>
</code></pre>
<p>If you need a fallback value for a nested shape <a href="#fallback-value">consider using <code>catch</code></a>.</p>
<p>Use <code>parseOrDefaultAsync</code> with <a href="#async-shapes">async shapes</a>. It has the same semantics and returns a promise.</p>

<a href="#try" id="try" style="color: inherit; text-decoration: none;">
  <h2><code>try</code></h2>
</a>
<p>It isn&#39;t always convenient to write a try-catch blocks to handle validation errors. Use <code>try</code> method in such cases:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">try</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ { ok: true, value: 42 }</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">try</span><span class="hl-0">(</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ { ok: false, issues: [{ code: &#39;type&#39;, … }] }</span>
</code></pre>
<p>Use <code>tryAsync</code> with <a href="#async-shapes">async shapes</a>. It has the same semantics and returns a promise.</p>

<a href="#validation-errors" id="validation-errors" style="color: inherit; text-decoration: none;">
  <h1>Validation errors</h1>
</a>
<p>Validation errors which are thrown by the <code>parse*</code> methods, and
<a href="https://smikhalevski.github.io/doubter/interfaces/Err.html"><code>Err</code></a> objects returned by the <code>try*</code> methods have the
<code>issues</code> property which holds an array of validation issues:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({ </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">() });</span><br/><span class="hl-8">// ⮕ Shape&lt;{ age: number }&gt;</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">result</span><span class="hl-0"> = </span><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">try</span><span class="hl-0">({ </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-1">&#39;Seventeen&#39;</span><span class="hl-0"> });</span>
</code></pre>
<p>The <code>result</code> contains the <a href="https://smikhalevski.github.io/doubter/interfaces/Err.html"><code>Err</code></a> object:</p>
<pre><code class="language-ts"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-10">ok</span><span class="hl-0">: </span><span class="hl-3">false</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-10">issues</span><span class="hl-0">: [</span><br/><span class="hl-0">    {</span><br/><span class="hl-0">      </span><span class="hl-4">code:</span><span class="hl-0"> </span><span class="hl-1">&#39;type&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">path:</span><span class="hl-0"> [</span><span class="hl-1">&#39;age&#39;</span><span class="hl-0">],</span><br/><span class="hl-0">      </span><span class="hl-4">input:</span><span class="hl-0"> </span><span class="hl-1">&#39;Seventeen&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">message:</span><span class="hl-0"> </span><span class="hl-1">&#39;Must be a number&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">param:</span><span class="hl-0"> </span><span class="hl-1">&#39;number&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">meta:</span><span class="hl-0"> </span><span class="hl-4">undefied</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  ]</span><br/><span class="hl-0">}</span>
</code></pre>
<dl>
<dt><code>code</code></dt>
<dd>

<p>Is the code of the validation issue. Shapes provide various checks and each check has a unique code.
In the example above, <code>type</code> code refers to a failed number type check. See the table of known codes below. You can
add <a href="#checks">a custom check</a> to any shape and return an issue with your custom code.</p>
</dd>
<dt><code>path</code></dt>
<dd>

<p>Is the object path, represented as an array that may contain strings, numbers (array indices and such), symbols, and
any other values (since they can be <code>Map</code> keys).</p>
</dd>
<dt><code>input</code></dt>
<dd>

<p>Is the input value that caused a validation issue. Note that if <a href="#type-coercion">coercion</a> is enabled this contains a
coerced value.</p>
</dd>
<dt><code>message</code></dt>
<dd>

<p>Is the human-readable issue message. Refer to <a href="#localization">Localization</a> section for more details.</p>
</dd>
<dt><code>param</code></dt>
<dd>

<p>Is the parameter value associated with the issue. Parameter value usually depends on <code>code</code>, see the table below.</p>
</dd>
<dt><code>meta</code></dt>
<dd>

<p>Is the optional metadata associated with the issue. Refer to <a href="#metadata">Metadata</a> section for more details.</p>
</dd>
</dl>

<br/>

<table>
<thead>
<tr>
<th align="left">Code</th>
<th align="left">Caused by</th>
<th align="left">Param</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>arrayMinLength</code></td>
<td align="left"><a href="#array"><code>d.array().min(n)</code></a></td>
<td align="left">The minimum array length <code>n</code></td>
</tr>
<tr>
<td align="left"><code>arrayMaxLength</code></td>
<td align="left"><a href="#array"><code>d.array().max(n)</code></a></td>
<td align="left">The maximum array length <code>n</code></td>
</tr>
<tr>
<td align="left"><code>const</code></td>
<td align="left"><a href="#const"><code>d.const(x)</code></a></td>
<td align="left">The expected constant value <code>x</code></td>
</tr>
<tr>
<td align="left"><code>enum</code></td>
<td align="left"><a href="#enum"><code>d.enum([x, y, z])</code></a></td>
<td align="left">The list of unique expected values<code>[x, y, z]</code></td>
</tr>
<tr>
<td align="left"><code>exclusion</code></td>
<td align="left"><a href="#exclude"><code>shape.exclude(x)</code></a></td>
<td align="left">The excluded value <code>x</code></td>
</tr>
<tr>
<td align="left"><code>instance</code></td>
<td align="left"><a href="#instanceof"><code>instanceOf(Class)</code></a></td>
<td align="left">The class constructor <code>Class</code></td>
</tr>
<tr>
<td align="left"><code>intersection</code></td>
<td align="left"><a href="#intersection"><code>d.and(…)</code></a></td>
<td align="left">—</td>
</tr>
<tr>
<td align="left"><code>json</code></td>
<td align="left"><a href="#json"><code>d.json()</code></a></td>
<td align="left">The message from <code>JSON.parse()</code></td>
</tr>
<tr>
<td align="left"><code>predicate</code></td>
<td align="left"><a href="#refinements"><code>shape.refine(…)</code></a></td>
<td align="left">The callback passed to <code>refine</code></td>
</tr>
<tr>
<td align="left"><code>numberInteger</code></td>
<td align="left"><a href="#integer"><code>d.integer()</code></a></td>
<td align="left">—</td>
</tr>
<tr>
<td align="left"><code>numberFinite</code></td>
<td align="left"><a href="#finite"><code>d.finite()</code></a></td>
<td align="left">—</td>
</tr>
<tr>
<td align="left"><code>numberGreaterThan</code></td>
<td align="left"><a href="#number"><code>d.number().gt(x)</code></a></td>
<td align="left">The exclusive minimum value <code>x</code></td>
</tr>
<tr>
<td align="left"><code>numberGreaterThanOrEqual</code></td>
<td align="left"><a href="#number"><code>d.number().gte(x)</code></a></td>
<td align="left">The minimum value <code>x</code></td>
</tr>
<tr>
<td align="left"><code>numberLessThan</code></td>
<td align="left"><a href="#number"><code>d.number().lt(x)</code></a></td>
<td align="left">The exclusive maximum value <code>x</code></td>
</tr>
<tr>
<td align="left"><code>numberLessThanOrEqual</code></td>
<td align="left"><a href="#number"><code>d.number().lte(x)</code></a></td>
<td align="left">The maximum value <code>x</code></td>
</tr>
<tr>
<td align="left"><code>numberMultipleOf</code></td>
<td align="left"><a href="#number"><code>d.number().multipleOf(x)</code></a></td>
<td align="left">The divisor <code>x</code></td>
</tr>
<tr>
<td align="left"><code>setMinSize</code></td>
<td align="left"><a href="#set"><code>d.set().min(n)</code></a></td>
<td align="left">The minimum <code>Set</code> size <code>n</code></td>
</tr>
<tr>
<td align="left"><code>setMaxSize</code></td>
<td align="left"><a href="#set"><code>d.set().max(n)</code></a></td>
<td align="left">The maximum <code>Set</code> size <code>n</code></td>
</tr>
<tr>
<td align="left"><code>stringMinLength</code></td>
<td align="left"><a href="#string"><code>d.string().min(n)</code></a></td>
<td align="left">The minimum string length <code>n</code></td>
</tr>
<tr>
<td align="left"><code>stringMaxLength</code></td>
<td align="left"><a href="#string"><code>d.string().max(n)</code></a></td>
<td align="left">The maximum string length <code>n</code></td>
</tr>
<tr>
<td align="left"><code>stringRegex</code></td>
<td align="left"><a href="#string"><code>d.string().regex(re)</code></a></td>
<td align="left">The regular expression <code>re</code></td>
</tr>
<tr>
<td align="left"><code>type</code></td>
<td align="left">All shapes</td>
<td align="left">The expected input value type <a href="#value-types"><sup>✱</sup></a></td>
</tr>
<tr>
<td align="left"><code>tuple</code></td>
<td align="left"><a href="#tuple"><code>d.tuple([…])</code></a></td>
<td align="left">The expected tuple length</td>
</tr>
<tr>
<td align="left"><code>union</code></td>
<td align="left"><a href="#union"><code>d.or(…)</code></a></td>
<td align="left">The array of expected input value types <a href="#value-types"><sup>✱</sup></a></td>
</tr>
<tr>
<td align="left"><code>unknownKeys</code></td>
<td align="left"><a href="#unknown-keys"><code>d.object().exact()</code></a></td>
<td align="left">The array of unknown keys</td>
</tr>
</tbody></table>
<p><a href="#value-types" name="value-types"><sup>✱</sup></a> The list of known value types:</p>
<ul>
<li><code>array</code></li>
<li><code>bigint</code></li>
<li><code>boolean</code></li>
<li><code>date</code></li>
<li><code>function</code></li>
<li><code>object</code></li>
<li><code>map</code></li>
<li><code>never</code></li>
<li><code>null</code></li>
<li><code>number</code></li>
<li><code>promise</code></li>
<li><code>set</code></li>
<li><code>string</code></li>
<li><code>symbol</code></li>
<li><code>undefined</code></li>
</ul>

<a href="#checks" id="checks" style="color: inherit; text-decoration: none;">
  <h1>Checks</h1>
</a>
<p>Checks allow constraining the input value beyond type assertions. For example, if you want to constrain an input number
to be greater than 5:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">check</span><span class="hl-0">(</span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-2">if</span><span class="hl-0"> (</span><span class="hl-4">value</span><span class="hl-0"> &lt;= </span><span class="hl-7">5</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-8">// 🟡 Return a partial issue</span><br/><span class="hl-0">    </span><span class="hl-2">return</span><span class="hl-0"> { </span><span class="hl-4">code:</span><span class="hl-0"> </span><span class="hl-1">&#39;kaputs&#39;</span><span class="hl-0"> };</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">10</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 10</span><br/><br/><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">3</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: kaputs at /</span>
</code></pre>
<p>A check callback receives the shape output value and must return a partial issue or an array of partial issues if the
value is invalid.</p>
<blockquote>
<p><strong>Note</strong>&ensp; Check callbacks can safely throw a <code>ValidationError</code> to notify Doubter that parsing issues occurred.
While this has the same effect as returning an array of issues, it is recommended to throw a <code>ValidationError</code> as the
last resort since catching errors has a high performance penalty.</p>
</blockquote>
<p>If value is valid, a check callback must return <code>null</code> or <code>undefined</code>.</p>
<p>Most shapes have a set of built-in checks. The check we&#39;ve just implemented above is called <code>gt</code> (greater than):</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">gt</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">);</span>
</code></pre>
<p>Add as many checks as you need to the shape. They are executed the same order they are defined.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">max</span><span class="hl-0">(</span><span class="hl-7">4</span><span class="hl-0">).</span><span class="hl-6">regex</span><span class="hl-0">(</span><span class="hl-11">/a/</span><span class="hl-0">).</span><span class="hl-6">try</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">);</span>
</code></pre>
<p>In the example above, an <a href="https://smikhalevski.github.io/doubter/interfaces/Err.html"><code>Err</code></a> object is returned:</p>
<pre><code class="language-ts"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-10">ok</span><span class="hl-0">: </span><span class="hl-3">false</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-10">issues</span><span class="hl-0">: [</span><br/><span class="hl-0">    {</span><br/><span class="hl-0">      </span><span class="hl-4">code:</span><span class="hl-0"> </span><span class="hl-1">&#39;stringMaxLength&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">path:</span><span class="hl-0"> [],</span><br/><span class="hl-0">      </span><span class="hl-4">input:</span><span class="hl-0"> </span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">message:</span><span class="hl-0"> </span><span class="hl-1">&#39;Must have the maximum length of 4&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">param:</span><span class="hl-0"> </span><span class="hl-7">4</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">meta:</span><span class="hl-0"> </span><span class="hl-4">undefied</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  ]</span><br/><span class="hl-0">}</span>
</code></pre>
<blockquote>
<p><strong>Note</strong>&ensp;You can find the list of issue codes and corresponding param values in
<a href="#validation-errors">Validation errors</a> section.</p>
</blockquote>
<p>Doubter halts parsing and raises a validation error as soon as the first issue was encountered. Sometimes you may want
to collect all issues that prevent input from being successfully parsed. To do this, pass a <code>verbose</code> option to a parse
method.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">max</span><span class="hl-0">(</span><span class="hl-7">4</span><span class="hl-0">).</span><span class="hl-6">regex</span><span class="hl-0">(</span><span class="hl-11">/a/</span><span class="hl-0">).</span><span class="hl-6">try</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">, { </span><span class="hl-4">verbose:</span><span class="hl-0"> </span><span class="hl-3">true</span><span class="hl-0"> });</span>
</code></pre>
<p>This would return the <a href="https://smikhalevski.github.io/doubter/interfaces/Err.html"><code>Err</code></a> object with two issues:</p>
<pre><code class="language-ts"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-10">ok</span><span class="hl-0">: </span><span class="hl-3">false</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-10">issues</span><span class="hl-0">: [</span><br/><span class="hl-0">    {</span><br/><span class="hl-0">      </span><span class="hl-4">code:</span><span class="hl-0"> </span><span class="hl-1">&#39;stringMaxLength&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">path:</span><span class="hl-0"> [],</span><br/><span class="hl-0">      </span><span class="hl-4">input:</span><span class="hl-0"> </span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">message:</span><span class="hl-0"> </span><span class="hl-1">&#39;Must have the maximum length of 4&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">param:</span><span class="hl-0"> </span><span class="hl-7">4</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">meta:</span><span class="hl-0"> </span><span class="hl-4">undefied</span><br/><span class="hl-0">    },</span><br/><span class="hl-0">    {</span><br/><span class="hl-0">      </span><span class="hl-4">code:</span><span class="hl-0"> </span><span class="hl-1">&#39;stringRegex&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">path:</span><span class="hl-0"> [],</span><br/><span class="hl-0">      </span><span class="hl-4">input:</span><span class="hl-0"> </span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">message:</span><span class="hl-0"> </span><span class="hl-1">&#39;Must match the pattern /a/&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">param:</span><span class="hl-11"> /a/</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-4">meta:</span><span class="hl-0"> </span><span class="hl-4">undefied</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  ]</span><br/><span class="hl-0">}</span>
</code></pre>

<a href="#safe-and-unsafe-checks" id="safe-and-unsafe-checks" style="color: inherit; text-decoration: none;">
  <h2>Safe and unsafe checks</h2>
</a>
<p>Checks that you add using a <code>check</code> method are marked as &quot;safe&quot; which means they aren&#39;t executed if any of the preceding
checks failed. Consider an object with a custom check:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">userShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">yearsOfExperience:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">}).</span><span class="hl-6">check</span><span class="hl-0">(</span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-2">if</span><span class="hl-0"> (</span><span class="hl-4">value</span><span class="hl-0">.</span><span class="hl-4">age</span><span class="hl-0"> &lt; </span><span class="hl-4">value</span><span class="hl-0">.</span><span class="hl-4">yearsOfExperience</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-2">return</span><span class="hl-0"> { </span><span class="hl-4">code:</span><span class="hl-0"> </span><span class="hl-1">&#39;inconsistentAge&#39;</span><span class="hl-0"> };</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ age: number, yearsOfExperience: number }&gt;</span>
</code></pre>
<p>The check callback relies on <code>value</code> to be an object with the valid set of properties. So if any issues are detected in
the input object the check won&#39;t be called:</p>
<pre><code class="language-ts"><span class="hl-8">// Check isn&#39;t called since yearsOfExperience isn&#39;t a number</span><br/><span class="hl-4">nameShape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({ </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-7">18</span><span class="hl-0"> });</span>
</code></pre>
<p>To force the check to be executed even if the preceding check has failed, pass the <code>unsafe</code> option to the check method:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">max</span><span class="hl-0">(</span><span class="hl-7">3</span><span class="hl-0">).</span><span class="hl-6">check</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-2">if</span><span class="hl-0"> (</span><span class="hl-4">value</span><span class="hl-0">.</span><span class="hl-6">toUpperCase</span><span class="hl-0">() !== </span><span class="hl-4">value</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-2">return</span><span class="hl-0"> { </span><span class="hl-4">message:</span><span class="hl-0"> </span><span class="hl-1">&#39;Must be all caps&#39;</span><span class="hl-0"> }</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  { </span><span class="hl-4">unsafe:</span><span class="hl-0"> </span><span class="hl-3">true</span><span class="hl-0"> }</span><br/><span class="hl-0">);</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">, { </span><span class="hl-4">verbose:</span><span class="hl-0"> </span><span class="hl-3">true</span><span class="hl-0"> });</span><br/><span class="hl-8">// ❌ ValidationError</span>
</code></pre>

<a href="#add-get-and-delete-checks" id="add-get-and-delete-checks" style="color: inherit; text-decoration: none;">
  <h2>Add, get and delete checks</h2>
</a>
<p>Let&#39;s consider the same check being added to the shape twice:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">emailCheck</span><span class="hl-0">: </span><span class="hl-9">d</span><span class="hl-0">.</span><span class="hl-9">CheckCallback</span><span class="hl-0"> = (</span><span class="hl-4">value</span><span class="hl-0">, </span><span class="hl-4">options</span><span class="hl-0">) </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-2">if</span><span class="hl-0"> (!</span><span class="hl-4">value</span><span class="hl-0">.</span><span class="hl-6">includes</span><span class="hl-0">(</span><span class="hl-1">&#39;@&#39;</span><span class="hl-0">)) {</span><br/><span class="hl-0">    </span><span class="hl-2">return</span><span class="hl-0"> { </span><span class="hl-4">code:</span><span class="hl-0"> </span><span class="hl-1">&#39;email&#39;</span><span class="hl-0"> };</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">};</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">check</span><span class="hl-0">(</span><span class="hl-4">emailCheck</span><span class="hl-0">).</span><span class="hl-6">check</span><span class="hl-0">(</span><span class="hl-4">emailCheck</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string&gt;</span>
</code></pre>
<p><code>emailCheck</code> check would be added to the shape only once, because Doubter makes checks to be distinct.</p>
<p>You can later delete a check you&#39;ve added:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">deleteCheck</span><span class="hl-0">(</span><span class="hl-4">emailCheck</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string&gt;</span>
</code></pre>
<p>Using a check callback as an identity isn&#39;t always convenient, so you can pass a <code>key</code> option:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">check</span><span class="hl-0">(</span><span class="hl-4">emailCheck</span><span class="hl-0">, { </span><span class="hl-4">key:</span><span class="hl-0"> </span><span class="hl-1">&#39;okay&#39;</span><span class="hl-0"> });</span><br/><span class="hl-8">// ⮕ Shape&lt;string&gt;</span>
</code></pre>
<p>Now you should use this key to delete the check:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">deleteCheck</span><span class="hl-0">(</span><span class="hl-1">&#39;okay&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string&gt;</span>
</code></pre>
<p>You can retrieve a check by its key. If <code>key</code> option was omitted, the check callback identity is used as a key:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">check</span><span class="hl-0">(</span><span class="hl-4">emailCheck</span><span class="hl-0">);</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">getCheck</span><span class="hl-0">(</span><span class="hl-4">emailCheck</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ { callback: emailCheck, unsafe: false, param: undefined }</span>
</code></pre>

<a href="#metadata" id="metadata" style="color: inherit; text-decoration: none;">
  <h2>Metadata</h2>
</a>
<p>Built-in checks have the <code>meta</code> option. Its value is later assigned to the <code>meta</code> property of the raised
<a href="#validation-errors">validation issue</a>.</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">gt</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">, { </span><span class="hl-4">meta:</span><span class="hl-0"> </span><span class="hl-1">&#39;Useful data&#39;</span><span class="hl-0"> });</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">result</span><span class="hl-0"> = </span><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">try</span><span class="hl-0">(</span><span class="hl-7">2</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ { ok: false, issues: … }</span><br/><br/><span class="hl-2">if</span><span class="hl-0"> (!</span><span class="hl-4">result</span><span class="hl-0">.</span><span class="hl-4">ok</span><span class="hl-0">) {</span><br/><span class="hl-0">  </span><span class="hl-4">result</span><span class="hl-0">.</span><span class="hl-4">issues</span><span class="hl-0">[</span><span class="hl-7">0</span><span class="hl-0">].</span><span class="hl-4">meta</span><span class="hl-0"> </span><span class="hl-8">// ⮕ &#39;Useful data&#39;</span><br/><span class="hl-0">}</span>
</code></pre>
<p>This comes handy if you want to enhance an issue with an additional data that can be used later during issues
processing. For example, during <a href="#localization">localization</a>.</p>

<a href="#refinements" id="refinements" style="color: inherit; text-decoration: none;">
  <h1>Refinements</h1>
</a>
<p>Refinements are a simplified checks that use a predicate to validate an input. For example, the shape below would raise
an issue if the input string is less than three characters long.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">refine</span><span class="hl-0">(</span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> </span><span class="hl-4">value</span><span class="hl-0">.</span><span class="hl-4">length</span><span class="hl-0"> &gt;= </span><span class="hl-7">3</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string&gt;</span>
</code></pre>
<p>Use refinements to <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html">narrow</a> the output type of the shape:</p>
<pre><code class="language-ts"><span class="hl-3">function</span><span class="hl-0"> </span><span class="hl-6">isMarsOrPluto</span><span class="hl-0">(</span><span class="hl-4">value</span><span class="hl-0">: </span><span class="hl-9">string</span><span class="hl-0">): </span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0"> | </span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-2">return</span><span class="hl-0"> </span><span class="hl-4">value</span><span class="hl-0"> === </span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0"> || </span><span class="hl-4">value</span><span class="hl-0"> === </span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">;</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">refine</span><span class="hl-0">(</span><span class="hl-4">isMarsOrPluto</span><span class="hl-0">)</span><br/><span class="hl-8">// ⮕ Shape&lt;string, &#39;Mars&#39; | &#39;Pluto&#39;&gt;</span>
</code></pre>

<a href="#transformations" id="transformations" style="color: inherit; text-decoration: none;">
  <h1>Transformations</h1>
</a>
<p>Along with validation, shapes can transform values. Let&#39;s consider a shape that takes a string as an input and converts
it to number:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">transform</span><span class="hl-0">(</span><span class="hl-4">parseFloat</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string, number&gt;</span>
</code></pre>
<p>This shape ensures that the input value is a string and passes it to a transformation callback:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;42&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 42</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Seventeen&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ NaN</span>
</code></pre>
<p>Throw a <code>ValidationError</code> inside the transformation callback to notify parser that transformation cannot be successfully
completed:</p>
<pre><code class="language-ts"><span class="hl-3">function</span><span class="hl-0"> </span><span class="hl-6">toNumber</span><span class="hl-0">(</span><span class="hl-4">input</span><span class="hl-0">: </span><span class="hl-9">string</span><span class="hl-0">): </span><span class="hl-9">number</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">output</span><span class="hl-0"> = </span><span class="hl-6">parseFloat</span><span class="hl-0">(</span><span class="hl-4">input</span><span class="hl-0">);</span><br/><br/><span class="hl-0">  </span><span class="hl-2">if</span><span class="hl-0"> (</span><span class="hl-6">isNaN</span><span class="hl-0">(</span><span class="hl-4">output</span><span class="hl-0">)) {</span><br/><span class="hl-0">    </span><span class="hl-2">throw</span><span class="hl-0"> </span><span class="hl-3">new</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">ValidationError</span><span class="hl-0">([{ </span><span class="hl-4">code:</span><span class="hl-0"> </span><span class="hl-1">&#39;kaputs&#39;</span><span class="hl-0"> }]);</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">  </span><span class="hl-2">return</span><span class="hl-0"> </span><span class="hl-4">output</span><span class="hl-0">;</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">transform</span><span class="hl-0">(</span><span class="hl-4">toNumber</span><span class="hl-0">);</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;42&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 42</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Seventeen&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: kaputs at /</span>
</code></pre>

<a href="#async-transformations" id="async-transformations" style="color: inherit; text-decoration: none;">
  <h2>Async transformations</h2>
</a>
<p>Let&#39;s consider a <em>sync</em> transformation:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">syncShape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">transform</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> </span><span class="hl-1">&#39;Hello, &#39;</span><span class="hl-0"> + </span><span class="hl-4">value</span><br/><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string&gt;</span><br/><br/><span class="hl-4">syncShape1</span><span class="hl-0">.</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-8">// ⮕ false</span><br/><br/><span class="hl-4">syncShape1</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Jill&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;Hello, Jill&#39;</span>
</code></pre>
<p>The transformation callback receives and returns a string and so does <code>syncShape1</code>.</p>
<p>Now lets return a promise from the transformation callback:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">syncShape2</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">transform</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> </span><span class="hl-9">Promise</span><span class="hl-0">.</span><span class="hl-6">resolve</span><span class="hl-0">(</span><span class="hl-1">&#39;Hello, &#39;</span><span class="hl-0"> + </span><span class="hl-4">value</span><span class="hl-0">)</span><br/><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string, Promise&lt;string&gt;&gt;</span><br/><br/><span class="hl-4">syncShape2</span><span class="hl-0">.</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-8">// ⮕ false</span><br/><br/><span class="hl-4">syncShape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Jill&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Promise&lt;string&gt;</span>
</code></pre>
<p>Notice that <code>syncShape2</code> is asymmetric: it expects a string input and transforms it to a <code>Promise&lt;string&gt;</code>. <code>syncShape2</code>
is still sync, since the transformation callback <em>synchronously wraps</em> a value in a promise.</p>
<p>Now let&#39;s create an <em>async</em> shape using the async transformation:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">asyncShape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">transformAsync</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> </span><span class="hl-9">Promise</span><span class="hl-0">.</span><span class="hl-6">resolve</span><span class="hl-0">(</span><span class="hl-1">&#39;Hello, &#39;</span><span class="hl-0"> + </span><span class="hl-4">value</span><span class="hl-0">)</span><br/><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string&gt;</span><br/><br/><span class="hl-8">// 🟡 Notice that the shape is async</span><br/><span class="hl-4">asyncShape1</span><span class="hl-0">.</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-8">// ⮕ true</span><br/><br/><span class="hl-2">await</span><span class="hl-0"> </span><span class="hl-4">asyncShape1</span><span class="hl-0">.</span><span class="hl-6">parseAsync</span><span class="hl-0">(</span><span class="hl-1">&#39;Jill&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;Hello, Jill&#39;</span>
</code></pre>
<p>Notice that <code>asyncShape1</code> still transforms the input string value to output string but the transformation itself is
async.</p>
<p>A shape is async if it uses async transformations. Here&#39;s an async object shape:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">asyncShape2</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">transformAsync</span><span class="hl-0">(</span><br/><span class="hl-0">    </span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> </span><span class="hl-9">Promise</span><span class="hl-0">.</span><span class="hl-6">resolve</span><span class="hl-0">(</span><span class="hl-4">value</span><span class="hl-0">)</span><br/><span class="hl-0">  )</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: string }&gt;</span><br/><br/><span class="hl-4">asyncShape2</span><span class="hl-0">.</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-8">// ⮕ true</span>
</code></pre>
<blockquote>
<p><strong>Note</strong>&ensp;Composite shapes are async if they rely on a <a href="#promise"><code>promise</code></a> shape:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">promise</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">())</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: Promise&lt;string&gt; }&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-8">// ⮕ true</span>
</code></pre>
</blockquote>

<a href="#parsing-context" id="parsing-context" style="color: inherit; text-decoration: none;">
  <h1>Parsing context</h1>
</a>
<p>Inside <a href="#checks">check</a> and <a href="#transformations">transform</a> callbacks you can access options passed to the parser. The
<code>context</code> option may store arbitrary data, which is <code>undefined</code> by default.</p>
<p>The example below shows how you can transform numbers to formatted strings using context:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">transform</span><span class="hl-0">(</span><br/><span class="hl-0">  (</span><span class="hl-4">value</span><span class="hl-0">, </span><span class="hl-4">options</span><span class="hl-0">) </span><span class="hl-3">=&gt;</span><span class="hl-0"> </span><span class="hl-3">new</span><span class="hl-0"> </span><span class="hl-4">Intl</span><span class="hl-0">.</span><span class="hl-6">NumberFormat</span><span class="hl-0">(</span><span class="hl-4">options</span><span class="hl-0">.</span><span class="hl-4">context</span><span class="hl-0">.</span><span class="hl-4">locale</span><span class="hl-0">).</span><span class="hl-6">format</span><span class="hl-0">(</span><span class="hl-4">value</span><span class="hl-0">)</span><br/><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;number, string&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-7">1000</span><span class="hl-0">,</span><br/><span class="hl-0">  {</span><br/><span class="hl-0">    </span><span class="hl-8">// 🟡 Pass a context</span><br/><span class="hl-0">    </span><span class="hl-4">context:</span><span class="hl-0"> { </span><span class="hl-4">locale:</span><span class="hl-0"> </span><span class="hl-1">&#39;en-US&#39;</span><span class="hl-0"> }</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;1,000&#39;</span>
</code></pre>

<a href="#shape-piping" id="shape-piping" style="color: inherit; text-decoration: none;">
  <h1>Shape piping</h1>
</a>
<p>With shape piping you to can pass the shape output to another shape.</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">transform</span><span class="hl-0">(</span><span class="hl-4">parseFloat</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string, number&gt;</span><br/><br/><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">to</span><span class="hl-0">(</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">lt</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">).</span><span class="hl-6">gt</span><span class="hl-0">(</span><span class="hl-7">10</span><span class="hl-0">));</span><br/><span class="hl-8">// ⮕ Shape&lt;string, number&gt;</span>
</code></pre>
<p>Piping is particularly useful in conjunction with <a href="#transformations">transformations</a> and <a href="#json">JSON shape</a>. The
example below shows how you can parse input JSON string and ensure that the output is an object:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape2</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">json</span><span class="hl-0">().</span><span class="hl-6">to</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({ </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">bigint</span><span class="hl-0">() }).</span><span class="hl-6">coerce</span><span class="hl-0">()</span><br/><span class="hl-0">);</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;{&quot;foo&quot;:&quot;6889063&quot;}&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ { foo: BigInt(6889063) }</span>
</code></pre>

<a href="#exclude" id="exclude" style="color: inherit; text-decoration: none;">
  <h1>Exclude</h1>
</a>
<p>Consider the enum shape:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">([</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;Jupiter&#39;</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;&#39;Mars&#39; | &#39;Pluto&#39; | &#39;Jupiter&#39;&gt;</span>
</code></pre>
<p>To exclude a value from this enum you can use <code>exclude</code>:</p>
<pre><code class="language-ts"><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">exclude</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;&#39;Mars&#39; | &#39;Jupiter&#39;&gt;</span>
</code></pre>
<p>Value exclusion works with any shape. For example, you can exclude a number:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape2</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">exclude</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">33</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 33</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: exclusion at /: Must not be equal to 42</span>
</code></pre>
<p>Exclude prohibits value for <em>both input and output</em>:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape3</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">transform</span><span class="hl-0">(</span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> </span><span class="hl-4">value</span><span class="hl-0"> * </span><span class="hl-7">2</span><span class="hl-0">).</span><span class="hl-6">exclude</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-4">shape3</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">21</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: exclusion at /: Must not be equal to 42</span>
</code></pre>

<a href="#include" id="include" style="color: inherit; text-decoration: none;">
  <h1>Include</h1>
</a>
<p>You can add a value to a multitude of input values:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">const</span><span class="hl-0">(</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">).</span><span class="hl-6">include</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;&#39;Mars&#39; | &#39;Pluto&#39;&gt;</span>
</code></pre>
<p>Included values don&#39;t go through checks and transformations of the underlying shape:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">gt</span><span class="hl-0">(</span><span class="hl-7">3</span><span class="hl-0">).</span><span class="hl-6">include</span><span class="hl-0">(</span><span class="hl-1">&#39;Seventeen&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;number | &#39;Seventeen&#39;&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">2</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: numberGreaterThan at /: Must be greater than 3</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">100</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;100&gt;</span><br/><br/><span class="hl-8">// 🟡 Notice that parsed value doesn&#39;t satisfy the number type and gt constraints</span><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Seventeen&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;Seventeen&#39;</span>
</code></pre>

<a href="#replace" id="replace" style="color: inherit; text-decoration: none;">
  <h1>Replace</h1>
</a>
<p>Include a value as an input and replace it with another value on the output side:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">const</span><span class="hl-0">(</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">).</span><span class="hl-6">replace</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;Jupiter&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;&#39;Mars&#39; | &#39;Pluto&#39;, &#39;Mars&#39; | &#39;Jupiter&#39;&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;Mars&#39;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;Jupiter&#39;</span>
</code></pre>
<p>Note that <code>replace</code> treats passed values as literals but in TypeScript type system not all values can be literals. For
example, there&#39;s no literal type for <code>NaN</code> which may cause unexpected result:</p>
<pre><code class="language-ts"><span class="hl-8">// 🔴 Note that the shape output is unexpectedly typed as 0</span><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">replace</span><span class="hl-0">(</span><span class="hl-3">NaN</span><span class="hl-0">, </span><span class="hl-7">0</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;number, 0&gt;</span>
</code></pre>
<p>Why is output inferred as 0 and not as a <code>number</code>? This occurs because <code>typeof NaN</code> is <code>number</code> and it is excluded from
the output type of the shape. For this particular case use <code>nan</code> method of number shape:</p>
<pre><code class="language-ts"><span class="hl-8">// 🟡 Note that the shape output is a number</span><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">nan</span><span class="hl-0">(</span><span class="hl-7">0</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">NaN</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 0</span>
</code></pre>

<a href="#optional-and-non-optional" id="optional-and-non-optional" style="color: inherit; text-decoration: none;">
  <h1>Optional and non-optional</h1>
</a>
<p>Marking a shape as optional allows <code>undefined</code> in both its input and output:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">optional</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;string | undefined&gt;</span>
</code></pre>
<p>You can provide a default value of any type, so it would be used as an output if input value is <code>undefined</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">optional</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string | undefined, string | 42&gt;</span>
</code></pre>
<p>You can achieve the same behaviour as <code>optional</code> using a union:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">undefined</span><span class="hl-0">()</span><br/><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;string | undefined&gt;</span>
</code></pre>
<p>Or using an inclusion:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">include</span><span class="hl-0">(</span><span class="hl-3">undefined</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string | undefined&gt;</span>
</code></pre>
<p>You can mark any shape as non-optional which effectively <a href="#exclude">excludes <code>undefined</code></a> values from both input and
output. For example, lets consider a union of an optional string and a number:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">optional</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;string | undefined | number&gt;</span><br/><br/><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">undefined</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ undefined</span>
</code></pre>
<p>Now let&#39;s mark this shape as non-optional:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape2</span><span class="hl-0"> = </span><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">nonOptional</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;string | number&gt;</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">undefined</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: exclusion at /: Must not be equal to undefined</span>
</code></pre>

<a href="#nullable-and-nullish" id="nullable-and-nullish" style="color: inherit; text-decoration: none;">
  <h1>Nullable and nullish</h1>
</a>
<p>Marking a shape as nullable allows <code>null</code> for both input and output:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">nullable</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;string | null&gt;</span>
</code></pre>
<p>You can provide a default value, so it would be used as an output if input value is <code>null</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">nullable</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string | null, string | 42&gt;</span>
</code></pre>
<p>To allow both <code>null</code> and <code>undefined</code> values use <code>nullish</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">nullish</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;string | null | undefined&gt;</span>
</code></pre>
<p><code>nullish</code> also supports the default value:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">nullish</span><span class="hl-0">(</span><span class="hl-7">8080</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string | null | undefined, string | 8080&gt;</span>
</code></pre>

<a href="#deep-partial" id="deep-partial" style="color: inherit; text-decoration: none;">
  <h1>Deep partial</h1>
</a>
<p>All object-like shapes (objects, arrays, maps, sets, promises, etc.) can be converted to a deep partial alternative
using <code>deepPartial</code> method:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">    </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">    </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">  })</span><br/><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;{ name: string, age: number }[]&gt;</span><br/><br/><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">deepPartial</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;Array&lt;{ name?: string, age?: number } | undefined&gt;&gt;</span>
</code></pre>
<p>Unions, intersections and lazy shapes can also be converted to deep partial:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape2</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({ </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">() })</span><br/><span class="hl-0">]).</span><span class="hl-6">deepPartial</span><span class="hl-0">()</span><br/><span class="hl-8">// ⮕ Shape&lt;number | { name?: string }&gt;</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 42</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({ </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-3">undefined</span><span class="hl-0"> });</span><br/><span class="hl-8">// ⮕ { name: undefined }</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({ </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-1">&#39;Frodo&#39;</span><span class="hl-0"> });</span><br/><span class="hl-8">// ⮕ { name: &#39;Frodo&#39; }</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({ </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-7">8080</span><span class="hl-0"> });</span><br/><span class="hl-8">// ❌ ValidationError: type at /name: Must be a string</span>
</code></pre>
<p>Deep partial isn&#39;t applied to transformed shapes:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape2</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">years:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()).</span><span class="hl-6">transform</span><span class="hl-0">(</span><span class="hl-4">parseFloat</span><span class="hl-0">)</span><br/><span class="hl-0">}).</span><span class="hl-6">deepPartial</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;{ years?: string[] }, { years?: number[] }&gt;</span>
</code></pre>

<a href="#fallback-value" id="fallback-value" style="color: inherit; text-decoration: none;">
  <h1>Fallback value</h1>
</a>
<p>If issues were detected during parsing a shape can return a fallback value.</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">catch</span><span class="hl-0">(</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">);</span><br/><br/><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;Pluto&#39;</span><br/><br/><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;Mars&#39;</span>
</code></pre>
<p>Pass a callback as a fallback value, it would be executed every time the catch clause is reached:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape2</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">catch</span><span class="hl-0">(</span><span class="hl-4">Date</span><span class="hl-0">.</span><span class="hl-4">now</span><span class="hl-0">);</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">)</span><br/><span class="hl-8">// ⮕ 42</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 1671565311528</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 1671565326707</span>
</code></pre>

<a href="#branded-types" id="branded-types" style="color: inherit; text-decoration: none;">
  <h1>Branded types</h1>
</a>
<p>TypeScript&#39;s type system is structural, which means that any two types that are structurally equivalent are considered
the same.</p>
<pre><code class="language-ts"><span class="hl-3">interface</span><span class="hl-0"> </span><span class="hl-9">Cat</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">name</span><span class="hl-0">: </span><span class="hl-9">string</span><span class="hl-0">;</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-3">interface</span><span class="hl-0"> </span><span class="hl-9">Dog</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">name</span><span class="hl-0">: </span><span class="hl-9">string</span><span class="hl-0">;</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-3">declare</span><span class="hl-0"> </span><span class="hl-3">function</span><span class="hl-0"> </span><span class="hl-6">petCat</span><span class="hl-0">(</span><span class="hl-4">cat</span><span class="hl-0">: </span><span class="hl-9">Cat</span><span class="hl-0">): </span><span class="hl-9">void</span><span class="hl-0">;</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">fidoDog</span><span class="hl-0">: </span><span class="hl-9">Dog</span><span class="hl-0"> = {</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-1">&#39;Fido&#39;</span><br/><span class="hl-0">};</span><br/><br/><span class="hl-6">petCat</span><span class="hl-0">(</span><span class="hl-4">fidoDog</span><span class="hl-0">);</span><br/><span class="hl-8">// ✅ Ok yet types are different</span>
</code></pre>
<p>In some cases, its can be desirable to simulate nominal typing inside TypeScript. For instance, you may wish to write a
function that only accepts an input that has been validated by Doubter. This can be achieved with branded types:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">catShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({ </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">() }).</span><span class="hl-6">brand</span><span class="hl-0">&lt;</span><span class="hl-1">&#39;Cat&#39;</span><span class="hl-0">&gt;();</span><br/><br/><span class="hl-3">type</span><span class="hl-0"> </span><span class="hl-9">Cat</span><span class="hl-0"> = </span><span class="hl-3">typeof</span><span class="hl-0"> </span><span class="hl-4">catShape</span><span class="hl-0">[</span><span class="hl-1">&#39;input&#39;</span><span class="hl-0">];</span><br/><br/><span class="hl-3">declare</span><span class="hl-0"> </span><span class="hl-3">function</span><span class="hl-0"> </span><span class="hl-6">petCat</span><span class="hl-0">(</span><span class="hl-4">cat</span><span class="hl-0">: </span><span class="hl-9">Cat</span><span class="hl-0">): </span><span class="hl-9">void</span><span class="hl-0">;</span><br/><br/><span class="hl-6">petCat</span><span class="hl-0">(</span><span class="hl-4">catShape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({ </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-1">&#39;Simba&#39;</span><span class="hl-0"> }));</span><br/><span class="hl-8">// ✅ Ok, since the cat was validated</span><br/><br/><span class="hl-6">petCat</span><span class="hl-0">({ </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-1">&#39;Fido&#39;</span><span class="hl-0"> });</span><br/><span class="hl-8">// ❌ Error: Expected BRAND to be Cat</span>
</code></pre>
<p>Under the hood, this works by attaching a &quot;brand&quot; to the inferred type using an intersection type. This way,
plain/unbranded data structures are no longer assignable to the inferred type of the shape.</p>
<p>Note that branded types do not affect the runtime result of <code>parse</code>. It is a static-only construct.</p>

<a href="#sub-shape-at-key" id="sub-shape-at-key" style="color: inherit; text-decoration: none;">
  <h1>Sub-shape at key</h1>
</a>
<p>Object, array, union ond other shapes provide access to their nested shapes:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">objectShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ name: string, age: number }&gt;</span><br/><br/><span class="hl-4">objectShape</span><span class="hl-0">.</span><span class="hl-4">shapes</span><span class="hl-0">.</span><span class="hl-4">name</span><span class="hl-0"> </span><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">unionShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">objectShape</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;string | { name: string, age: number }&gt;</span><br/><br/><span class="hl-4">unionShape</span><span class="hl-0">.</span><span class="hl-4">shapes</span><span class="hl-0">[</span><span class="hl-7">1</span><span class="hl-0">] </span><span class="hl-8">// ⮕ objectShape</span>
</code></pre>
<p><code>at</code> method derives a sub-shape at the given key, and if there&#39;s no key <code>null</code> is returned:</p>
<pre><code class="language-ts"><span class="hl-4">objectShape</span><span class="hl-0">.</span><span class="hl-6">at</span><span class="hl-0">(</span><span class="hl-1">&#39;age&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-4">objectShape</span><span class="hl-0">.</span><span class="hl-6">at</span><span class="hl-0">(</span><span class="hl-1">&#39;unknownKey&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ null</span>
</code></pre>
<p>This is especially useful with composite shapes:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">    </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()</span><br/><span class="hl-0">  }),</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">    </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">  })</span><br/><span class="hl-0">]);</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">at</span><span class="hl-0">(</span><span class="hl-1">&#39;foo&#39;</span><span class="hl-0">)</span><br/><span class="hl-8">// ⮕ Shape&lt;string | number&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">at</span><span class="hl-0">(</span><span class="hl-1">&#39;bar&#39;</span><span class="hl-0">)</span><br/><span class="hl-8">// ⮕ null</span>
</code></pre>

<a href="#localization" id="localization" style="color: inherit; text-decoration: none;">
  <h1>Localization</h1>
</a>
<p>All shape factories and built-in checks support custom issue messages:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(</span><span class="hl-1">&#39;Hey, string here&#39;</span><span class="hl-0">).</span><span class="hl-6">min</span><span class="hl-0">(</span><span class="hl-7">3</span><span class="hl-0">, </span><span class="hl-1">&#39;Too short&#39;</span><span class="hl-0">);</span>
</code></pre>
<p>Checks that have a param, such as <code>min</code> constraint in the example above, can use a <code>%s</code> placeholder that would be
interpolated with the param value.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">min</span><span class="hl-0">(</span><span class="hl-7">3</span><span class="hl-0">, </span><span class="hl-1">&#39;Minimum length is %s&#39;</span><span class="hl-0">);</span>
</code></pre>
<p>Pass a function as a message, and it would receive a check param, an <a href="#validation-errors">issue code</a>, an input value,
<a href="#metadata">a metadata</a>, and parsing options and should return a formatted message value. The returned formatted message
can be of any type.</p>
<p>For example, when using with React you may return a JSX element:</p>
<pre><code class="language-tsx"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-6">gtMessage</span><span class="hl-0">: </span><span class="hl-9">d</span><span class="hl-0">.</span><span class="hl-9">Message</span><span class="hl-0"> = (</span><span class="hl-4">param</span><span class="hl-0">, </span><span class="hl-4">code</span><span class="hl-0">, </span><span class="hl-4">input</span><span class="hl-0">, </span><span class="hl-4">meta</span><span class="hl-0">, </span><span class="hl-4">options</span><span class="hl-0">) </span><span class="hl-3">=&gt;</span><span class="hl-0"> (</span><br/><span class="hl-0">  </span><span class="hl-12">&lt;</span><span class="hl-13">span</span><span class="hl-0"> </span><span class="hl-14">style</span><span class="hl-0">=</span><span class="hl-3">{</span><span class="hl-15">{ </span><span class="hl-4">color:</span><span class="hl-15"> </span><span class="hl-1">&#39;red&#39;</span><span class="hl-15"> }</span><span class="hl-3">}</span><span class="hl-12">&gt;</span><br/><span class="hl-0">    Minimum length is </span><span class="hl-3">{</span><span class="hl-4">param</span><span class="hl-3">}</span><br/><span class="hl-0">  </span><span class="hl-12">&lt;/</span><span class="hl-13">span</span><span class="hl-12">&gt;</span><br/><span class="hl-0">);</span><br/><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">gt</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">, </span><span class="hl-4">gtMessage</span><span class="hl-0">);</span>
</code></pre>
<p>All rules described above are applied to the <code>message</code> option as well:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">length</span><span class="hl-0">(</span><span class="hl-7">3</span><span class="hl-0">, { </span><span class="hl-4">message:</span><span class="hl-0"> </span><span class="hl-1">&#39;Expected length is %s&#39;</span><span class="hl-0"> })</span>
</code></pre>

<a href="#integrations" id="integrations" style="color: inherit; text-decoration: none;">
  <h1>Integrations</h1>
</a>
<p>How to validate an email or UUID? Combine Doubter with your favourite predicate library:</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-0"> </span><span class="hl-3">*</span><span class="hl-0"> </span><span class="hl-2">as</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0"> </span><span class="hl-2">from</span><span class="hl-0"> </span><span class="hl-1">&#39;doubter&#39;</span><span class="hl-0">;</span><br/><span class="hl-2">import</span><span class="hl-0"> </span><span class="hl-4">isEmail</span><span class="hl-0"> </span><span class="hl-2">from</span><span class="hl-0"> </span><span class="hl-1">&#39;validator/lib/isEmail&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">emailShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">any</span><span class="hl-0">&lt;</span><span class="hl-9">string</span><span class="hl-0">&gt;(</span><span class="hl-4">isEmail</span><span class="hl-0">, </span><span class="hl-1">&#39;Must be an email&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string&gt;</span><br/><br/><span class="hl-4">emailShape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Not an email&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: predicate at /: Must be an email</span><br/><br/><span class="hl-4">emailShape</span><span class="hl-0">.</span><span class="hl-6">getCheck</span><span class="hl-0">(</span><span class="hl-4">isEmail</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ { key: isEmail, … }</span>
</code></pre>

<a href="#guarded-functions" id="guarded-functions" style="color: inherit; text-decoration: none;">
  <h1>Guarded functions</h1>
</a>
<p>Returns a function which parses arguments using provided shapes:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">callback</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">guard</span><span class="hl-0">([</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">boolean</span><span class="hl-0">()], (</span><span class="hl-4">arg1</span><span class="hl-0">, </span><span class="hl-4">arg2</span><span class="hl-0">) </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// arg1 is string</span><br/><span class="hl-0">  </span><span class="hl-8">// arg2 is boolean</span><br/><span class="hl-0">});</span>
</code></pre>
<p>Or check all arguments with a shape that parses arrays:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">callback</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">guard</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()), (...</span><span class="hl-4">args</span><span class="hl-0">) </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// args is string[]</span><br/><span class="hl-0">});</span>
</code></pre>
<p>Or if you have a single non-array argument, you can pass its shape:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">callback</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">guard</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">arg</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// arg is string</span><br/><span class="hl-0">});</span>
</code></pre>
<p>To guard multiple functions omit the callback parameter and a factory function would be returned:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">callbackFactory</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">guard</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">());</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">callback</span><span class="hl-0"> = </span><span class="hl-6">callbackFactory</span><span class="hl-0">(</span><span class="hl-4">arg</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// arg is string</span><br/><span class="hl-0">});</span>
</code></pre>
<p>If you are want to use async shapes to parse arguments, use <code>guardAsync</code> which has the same signatures as <code>guard</code>.</p>

<a href="#type-coercion" id="type-coercion" style="color: inherit; text-decoration: none;">
  <h1>Type coercion</h1>
</a>
<p>Type coercion is the process of converting value from one type to another (such as string to number, array to <code>Set</code>,
and so on).</p>
<p>When coercion is enabled, input values are implicitly converted to the required input type whenever possible.
For example, you can coerce input values to string type:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-7">8080</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ &#39;8080&#39;</span><br/><br/><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">null</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;&#39;</span>
</code></pre>
<p>Coercion can be enabled on shape-by-shape basis (as shown in the example above), or it can be enabled for all shapes
when <code>coerced</code> option is passed to a <a href="#parsing-and-trying">parsing method</a>:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape2</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">birthday:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">date</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><br/><span class="hl-0">  {</span><br/><span class="hl-0">    </span><span class="hl-4">name:</span><span class="hl-0"> [</span><span class="hl-1">&#39;Jake&#39;</span><span class="hl-0">],</span><br/><span class="hl-0">    </span><span class="hl-4">birthday:</span><span class="hl-0"> </span><span class="hl-1">&#39;1949-01-24&#39;</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  { </span><span class="hl-4">coerced:</span><span class="hl-0"> </span><span class="hl-3">true</span><span class="hl-0"> }</span><br/><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ { name: &#39;Jake&#39;, birthday: new Date(-660700800000) }</span>
</code></pre>
<p>Coercion rules differ from JavaScript so the behavior is more predictable and human-like.</p>

<a href="#coerce-to-string" id="coerce-to-string" style="color: inherit; text-decoration: none;">
  <h2>Coerce to string</h2>
</a>
<p><code>null</code> and <code>undefined</code> are converted to an empty string:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">null</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;&#39;</span>
</code></pre>
<p>Finite numbers, boolean and bigint values are converted via <code>String(value)</code>:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-6">BigInt</span><span class="hl-0">(</span><span class="hl-7">2398955</span><span class="hl-0">));</span><br/><span class="hl-8">// ⮕ &#39;2398955&#39;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-7">8080</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ &#39;8080&#39;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(-</span><span class="hl-3">Infinity</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a string</span>
</code></pre>
<p>Valid dates are converted to an ISO formatted string:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">new</span><span class="hl-0"> </span><span class="hl-6">Date</span><span class="hl-0">(</span><span class="hl-7">1674352106419</span><span class="hl-0">));</span><br/><span class="hl-8">// ⮕ &#39;2023-01-22T01:48:26.419Z&#39;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">new</span><span class="hl-0"> </span><span class="hl-6">Date</span><span class="hl-0">(</span><span class="hl-3">NaN</span><span class="hl-0">));</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a string</span>
</code></pre>
<p>Arrays with a single element are unwrapped and the value is coerced:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-3">undefined</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ &#39;&#39;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-1">&#39;Jill&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;Sarah&#39;</span><span class="hl-0">]);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a string</span>
</code></pre>

<a href="#coerce-to-number" id="coerce-to-number" style="color: inherit; text-decoration: none;">
  <h2>Coerce to number</h2>
</a>
<p><code>null</code> and <code>undefined</code> values are converted to 0:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">null</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 0</span>
</code></pre>
<p>Strings, boolean values and <code>Date</code> objects are converted using <code>+value</code>:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;42&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 42</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Seventeen&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a number</span>
</code></pre>
<p>Arrays with a single element are unwrapped and the value is coerced:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-3">new</span><span class="hl-0"> </span><span class="hl-6">Date</span><span class="hl-0">(</span><span class="hl-1">&#39;2023-01-22&#39;</span><span class="hl-0">)]);</span><br/><span class="hl-8">// ⮕ 1674345600000</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-7">1997</span><span class="hl-0">, </span><span class="hl-7">1998</span><span class="hl-0">]);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a number</span>
</code></pre>

<a href="#coerce-to-boolean" id="coerce-to-boolean" style="color: inherit; text-decoration: none;">
  <h2>Coerce to boolean</h2>
</a>
<p><code>null</code>, <code>undefined</code>, <code>&#39;false&#39;</code> and 0 are converted to <code>false</code>:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">boolean</span><span class="hl-0">().</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">null</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ false</span>
</code></pre>
<p><code>&#39;true&#39;</code> and 1 are converted to <code>true</code>:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;true&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ true</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;yes&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a boolean</span>
</code></pre>
<p>Arrays with a single element are unwrapped and the value is coerced:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-3">undefined</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ false</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-7">0</span><span class="hl-0">, </span><span class="hl-7">1</span><span class="hl-0">]);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a boolean</span>
</code></pre>

<a href="#coerce-to-bigint" id="coerce-to-bigint" style="color: inherit; text-decoration: none;">
  <h2>Coerce to bigint</h2>
</a>
<p><code>null</code> and <code>undefined</code> are converted to 0:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">bigint</span><span class="hl-0">().</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">null</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ BigInt(0)</span>
</code></pre>
<p>Number, string and boolean values are converted via <code>BigInt(value)</code>:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;18588&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ BigInt(18588)</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Unexpected&#39;</span><span class="hl-0">)</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a bigint</span>
</code></pre>
<p>Arrays with a single element are unwrapped and the value is coerced:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-7">0xdea</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ BigInt(3562)</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-6">BigInt</span><span class="hl-0">(</span><span class="hl-7">1</span><span class="hl-0">), </span><span class="hl-6">BigInt</span><span class="hl-0">(</span><span class="hl-7">2</span><span class="hl-0">)]);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a bigint</span>
</code></pre>

<a href="#coerce-to-enum" id="coerce-to-enum" style="color: inherit; text-decoration: none;">
  <h2>Coerce to enum</h2>
</a>
<p>If an enum is defined via a native TypeScript enum or via a const object, then enum element names are coerced to
corresponding values:</p>
<pre><code class="language-ts"><span class="hl-3">enum</span><span class="hl-0"> </span><span class="hl-9">Users</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-5">JILL</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">SARAH</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">JAMES</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">(</span><span class="hl-4">Users</span><span class="hl-0">).</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;SARAH&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 1</span>
</code></pre>
<p>Arrays with a single element are unwrapped and the value is coerced:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-1">&#39;JAMES&#39;</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ 2</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-7">1</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ 1</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-7">1</span><span class="hl-0">, </span><span class="hl-7">2</span><span class="hl-0">]);</span><br/><span class="hl-8">// ❌ ValidationError: enum at /: Must be equal to one of 0,1,2</span>
</code></pre>

<a href="#coerce-to-array" id="coerce-to-array" style="color: inherit; text-decoration: none;">
  <h2>Coerce to array</h2>
</a>
<p>Iterables and array-like objects are converted to array via <code>Array.from(value)</code>:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()).</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">new</span><span class="hl-0"> </span><span class="hl-6">Set</span><span class="hl-0">([</span><span class="hl-1">&#39;John&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;Jack&#39;</span><span class="hl-0">]));</span><br/><span class="hl-8">// ⮕ [&#39;John&#39;, &#39;Jack&#39;]</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({ </span><span class="hl-7">0</span><span class="hl-4">:</span><span class="hl-0"> </span><span class="hl-1">&#39;Bill&#39;</span><span class="hl-0">, </span><span class="hl-7">1</span><span class="hl-4">:</span><span class="hl-0"> </span><span class="hl-1">&#39;Jill&#39;</span><span class="hl-0">, </span><span class="hl-4">length:</span><span class="hl-0"> </span><span class="hl-7">2</span><span class="hl-0"> });</span><br/><span class="hl-8">// ⮕ [&#39;Bill&#39;, &#39;Jill&#39;]</span>
</code></pre>
<p>Scalars, non-iterable and non-array-like objects are wrapped into an array:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Rose&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ [&#39;Rose&#39;]</span>
</code></pre>

<a href="#coerce-to-date" id="coerce-to-date" style="color: inherit; text-decoration: none;">
  <h2>Coerce to <code>Date</code></h2>
</a>
<p>Strings and numbers are converted via <code>new Date(value)</code> and if an invalid date is produced then an issue is raised:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">date</span><span class="hl-0">().</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;2023-01-22&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Date</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;Yesterday&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a Date</span>
</code></pre>
<p>Arrays with a single element are unwrapped and the value is coerced:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-7">1674352106419</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Date</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-1">&#39;2021-12-03&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;2023-01-22&#39;</span><span class="hl-0">]);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a Date</span>
</code></pre>

<a href="#coerce-to-promise" id="coerce-to-promise" style="color: inherit; text-decoration: none;">
  <h2>Coerce to <code>Promise</code></h2>
</a>
<p>All values are converted to a promise by wrapping it in <code>Promise.resolve()</code>:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">promise</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()).</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parseAsync</span><span class="hl-0">(</span><span class="hl-7">42</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Promise&lt;number&gt;</span>
</code></pre>

<a href="#coerce-to-map" id="coerce-to-map" style="color: inherit; text-decoration: none;">
  <h2>Coerce to <code>Map</code></h2>
</a>
<p>Arrays, iterables and array-like objects that withhold entry-like elements (a tuple with two elements) are converted to
<code>Map</code> entries via <code>Array.from(value)</code>:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">map</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()).</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><br/><span class="hl-0">  [</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">, </span><span class="hl-7">0.1199</span><span class="hl-0">],</span><br/><span class="hl-0">  [</span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">, </span><span class="hl-7">5.3361</span><span class="hl-0">]</span><br/><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Map { &#39;Mars&#39; → 0.1199, &#39;Pluto&#39; → 5.3361 }</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-1">&#39;Jake&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;Bill&#39;</span><span class="hl-0">]);</span><br/><span class="hl-8">// ❌ ValidationError: type at /: Must be a Map</span>
</code></pre>
<p>Other objects are converted to an array of entries via <code>new Map(Object.entries(value))</code>:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">Jake:</span><span class="hl-0"> </span><span class="hl-7">31</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-4">Jill:</span><span class="hl-0"> </span><span class="hl-7">28</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Map { &#39;Jake&#39; → 31, &#39;Jill&#39; → 28 }</span>
</code></pre>

<a href="#coerce-to-set" id="coerce-to-set" style="color: inherit; text-decoration: none;">
  <h2>Coerce to <code>Set</code></h2>
</a>
<p>Arrays, iterables and array-like objects converted to <code>Set</code> values via <code>Array.from(value)</code>:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">set</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()).</span><span class="hl-6">coerce</span><span class="hl-0">();</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">([</span><span class="hl-1">&#39;Boris&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;K&#39;</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Set { &#39;Boris&#39;, &#39;K&#39; }</span>
</code></pre>
<p>Scalars, non-iterable and non-array-like objects are wrapped into an array:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;J&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Set { &#39;J&#39; }</span>
</code></pre>

<a href="#cookbook" id="cookbook" style="color: inherit; text-decoration: none;">
  <h1>Cookbook</h1>
</a>
<p>Tasty recipes from the chef.</p>

<a href="#rename-object-keys" id="rename-object-keys" style="color: inherit; text-decoration: none;">
  <h2>Rename object keys</h2>
</a>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">keyShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">([</span><span class="hl-1">&#39;foo&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;bar&#39;</span><span class="hl-0">]).</span><span class="hl-6">transform</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> </span><span class="hl-4">value</span><span class="hl-0">.</span><span class="hl-6">toUpperCase</span><span class="hl-0">() </span><span class="hl-2">as</span><span class="hl-0"> </span><span class="hl-1">&#39;FOO&#39;</span><span class="hl-0"> | </span><span class="hl-1">&#39;BAR&#39;</span><br/><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;&#39;foo&#39; | &#39;bar&#39;, &#39;FOO&#39; | &#39;BAR&#39;&gt;</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">record</span><span class="hl-0">(</span><span class="hl-4">keyShape</span><span class="hl-0">, </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">());</span><br/><span class="hl-8">// ⮕ Shape&lt;Record&lt;&#39;foo&#39; | &#39;bar&#39;, number&gt;, Record&lt;&#39;FOO&#39; | &#39;BAR&#39;, number&gt;&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({ </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-7">1</span><span class="hl-0">, </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-7">2</span><span class="hl-0"> });</span><br/><span class="hl-8">// ⮕ { FOO: 1, BAR: 2 }</span>
</code></pre>

<a href="#type-safe-url-query-params" id="type-safe-url-query-params" style="color: inherit; text-decoration: none;">
  <h2>Type-safe URL query params</h2>
</a>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-0"> </span><span class="hl-4">qs</span><span class="hl-0"> </span><span class="hl-2">from</span><span class="hl-0"> </span><span class="hl-1">&#39;qs&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">queryShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">optional</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">int</span><span class="hl-0">().</span><span class="hl-6">gt</span><span class="hl-0">(</span><span class="hl-7">0</span><span class="hl-0">).</span><span class="hl-6">coerce</span><span class="hl-0">().</span><span class="hl-6">catch</span><span class="hl-0">().</span><span class="hl-6">optional</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ name: string | undefined, age: number | undefined }&gt;</span><br/><br/><span class="hl-4">queryShape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-4">qs</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;name=Frodo&amp;age=50&#39;</span><span class="hl-0">));</span><br/><span class="hl-8">// ⮕ { name: &#39;Frodo&#39;, age: 50 }</span><br/><br/><span class="hl-4">queryShape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-4">qs</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;age=-33&#39;</span><span class="hl-0">));</span><br/><span class="hl-8">// ⮕ { age: undefined }</span>
</code></pre>

<a href="#performance" id="performance" style="color: inherit; text-decoration: none;">
  <h1>Performance</h1>
</a>
<p>The chart below showcases the performance comparison in terms of millions of operations per second (greater is better).
Tests were conducted using <a href="https://github.com/smikhalevski/toofast">TooFast</a>.</p>
<p align="center">
  <img src="./images/perf.svg" alt="Performance comparison chart"/>
</p>

<p>Clone this repo and use <code>npm ci &amp;&amp; npm run perf</code> to run the performance testsuite.</p>
<p>Validation performance was measured for the following object:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">value</span><span class="hl-0"> = {</span><br/><span class="hl-0">  </span><span class="hl-4">a1:</span><span class="hl-0"> [</span><span class="hl-7">1</span><span class="hl-0">, </span><span class="hl-7">2</span><span class="hl-0">, </span><span class="hl-7">3</span><span class="hl-0">],</span><br/><span class="hl-0">  </span><span class="hl-4">a2:</span><span class="hl-0"> </span><span class="hl-1">&#39;foo&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-4">a3:</span><span class="hl-0"> </span><span class="hl-3">false</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-4">a4:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">a41:</span><span class="hl-0"> </span><span class="hl-1">&#39;bar&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-4">a42:</span><span class="hl-0"> </span><span class="hl-7">3.1415</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">};</span>
</code></pre>
<p>The Doubter shape under test:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">a1:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">int</span><span class="hl-0">()),</span><br/><span class="hl-0">  </span><span class="hl-4">a2:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">min</span><span class="hl-0">(</span><span class="hl-7">3</span><span class="hl-0">),</span><br/><span class="hl-0">  </span><span class="hl-4">a3:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">boolean</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">a4:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">    </span><span class="hl-4">a41:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">([</span><span class="hl-1">&#39;foo&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;bar&#39;</span><span class="hl-0">]),</span><br/><span class="hl-0">    </span><span class="hl-4">a42:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">  })</span><br/><span class="hl-0">});</span>
</code></pre>

<a href="#data-types" id="data-types" style="color: inherit; text-decoration: none;">
  <h1>Data types</h1>
</a>
<p>🔎 <a href="https://smikhalevski.github.io/doubter/">API documentation is available here.</a></p>

<a href="#any" id="any" style="color: inherit; text-decoration: none;">
  <h2><code>any</code></h2>
</a>
<p>An unconstrained value that is inferred as <code>any</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">any</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;any&gt;</span>
</code></pre>
<p>Use <code>any</code> to create shapes that are unconstrained at runtime but constrained at compile time:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">any</span><span class="hl-0">&lt;{ </span><span class="hl-4">foo</span><span class="hl-0">: </span><span class="hl-9">string</span><span class="hl-0"> }&gt;();</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: string }&gt;</span>
</code></pre>
<p>Create a shape that is constrained by a
<a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html">narrowing predicate</a>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">any</span><span class="hl-0">((</span><span class="hl-4">value</span><span class="hl-0">): </span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">is</span><span class="hl-0"> </span><span class="hl-9">string</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> </span><span class="hl-3">typeof</span><span class="hl-0"> </span><span class="hl-4">value</span><span class="hl-0"> === </span><span class="hl-1">&#39;string&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;any, string&gt;</span>
</code></pre>

<a href="#array" id="array" style="color: inherit; text-decoration: none;">
  <h2><code>array</code></h2>
</a>
<p>Constrains a value to be an array:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;any[]&gt;</span>
</code></pre>
<p>Restrict array element types:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">());</span><br/><span class="hl-8">// ⮕ Shape&lt;number[]&gt;</span>
</code></pre>
<p>Constrain the length of an array:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()).</span><span class="hl-6">min</span><span class="hl-0">(</span><span class="hl-7">1</span><span class="hl-0">).</span><span class="hl-6">max</span><span class="hl-0">(</span><span class="hl-7">10</span><span class="hl-0">);</span>
</code></pre>
<p>Limit both minimum and maximum array length at the same time:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()).</span><span class="hl-6">length</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">);</span>
</code></pre>
<p>Transform array values during parsing:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">transform</span><span class="hl-0">(</span><span class="hl-4">parseFloat</span><span class="hl-0">));</span><br/><span class="hl-8">// ⮕ Shape&lt;string[], number[]&gt;</span>
</code></pre>

<a href="#bigint" id="bigint" style="color: inherit; text-decoration: none;">
  <h2><code>bigint</code></h2>
</a>
<p>Constrains a value to be a bigint.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">bigint</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;bigint&gt;</span>
</code></pre>

<a href="#boolean" id="boolean" style="color: inherit; text-decoration: none;">
  <h2><code>boolean</code></h2>
</a>
<p>Constrains a value to be boolean.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">boolean</span><span class="hl-0">();</span><br/><span class="hl-8">// or</span><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">bool</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;boolean&gt;</span>
</code></pre>

<a href="#const" id="const" style="color: inherit; text-decoration: none;">
  <h2><code>const</code></h2>
</a>
<p>Constrains a value to be an exact value:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">const</span><span class="hl-0">(</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;&#39;Mars&#39;&gt;</span>
</code></pre>
<p>There are shortcuts for <a href="#null"><code>null</code></a>, <a href="#undefined"><code>undefined</code></a> and <a href="#nan"><code>nan</code></a> constants.</p>
<p>Consider using <a href="#enum"><code>enum</code></a> if you want a value to be one of multiple literal values.</p>

<a href="#date" id="date" style="color: inherit; text-decoration: none;">
  <h2><code>date</code></h2>
</a>
<p>Constrains a value to be a valid date.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">date</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;Date&gt;</span>
</code></pre>

<a href="#enum" id="enum" style="color: inherit; text-decoration: none;">
  <h2><code>enum</code></h2>
</a>
<p>Constrains a value to be equal to one of predefined values:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">([</span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;Jupiter&#39;</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;&#39;Mars&#39;, &#39;Pluto&#39;, &#39;Jupiter&#39;&gt;</span>
</code></pre>
<p>Or use a native TypeScript enum to limit possible values:</p>
<pre><code class="language-ts"><span class="hl-3">enum</span><span class="hl-0"> </span><span class="hl-9">Planet</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-5">MARS</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">PLUTO</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">JUPITER</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">(</span><span class="hl-4">Planet</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;Planet&gt;</span>
</code></pre>
<p>Or use
<a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-4.html#const-assertions">an object with a <code>const</code> assertion</a>:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">planets</span><span class="hl-0"> = {</span><br/><span class="hl-0">  </span><span class="hl-4">MARS:</span><span class="hl-0"> </span><span class="hl-1">&#39;Mars&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-4">PLUTO:</span><span class="hl-0"> </span><span class="hl-1">&#39;Pluto&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-4">JUPITER:</span><span class="hl-0"> </span><span class="hl-1">&#39;Jupiter&#39;</span><br/><span class="hl-0">} </span><span class="hl-2">as</span><span class="hl-0"> </span><span class="hl-3">const</span><span class="hl-0">;</span><br/><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">(</span><span class="hl-4">plants</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;&#39;Mars&#39;, &#39;Pluto&#39;, &#39;Jupiter&#39;&gt;</span>
</code></pre>

<a href="#finite" id="finite" style="color: inherit; text-decoration: none;">
  <h2><code>finite</code></h2>
</a>
<p>Constrains a value to be a finite number.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">finite</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span>
</code></pre>

<a href="#instanceof" id="instanceof" style="color: inherit; text-decoration: none;">
  <h2><code>instanceOf</code></h2>
</a>
<p>Constrains a value to be an object that is an instance of a class:</p>
<pre><code class="language-ts"><span class="hl-3">class</span><span class="hl-0"> </span><span class="hl-9">User</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">name</span><span class="hl-0">?: </span><span class="hl-9">string</span><span class="hl-0">;</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">instanceOf</span><span class="hl-0">(</span><span class="hl-4">User</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;User&gt;</span>
</code></pre>

<a href="#integer" id="integer" style="color: inherit; text-decoration: none;">
  <h2><code>integer</code></h2>
</a>
<p>Constrains a value to be an integer.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">integer</span><span class="hl-0">().</span><span class="hl-6">min</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span><br/><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">int</span><span class="hl-0">().</span><span class="hl-6">max</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span>
</code></pre>
<p>This is a shortcut for number shape declaration:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">integer</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span>
</code></pre>
<p>Integers follow <a href="#coerce-to-number">number type coercion rules</a>.</p>

<a href="#intersection" id="intersection" style="color: inherit; text-decoration: none;">
  <h2><code>intersection</code></h2>
</a>
<p>Creates a shape that checks that the input value conforms to all shapes.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">intersection</span><span class="hl-0">([</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">    </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()</span><br/><span class="hl-0">  }),</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">    </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">  })</span><br/><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;{ name: string } &amp; { age: number }&gt;</span>
</code></pre>
<p>Or use a shorter alias <code>and</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">and</span><span class="hl-0">([</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()),</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">([</span><span class="hl-1">&#39;Peter&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;Paul&#39;</span><span class="hl-0">]))</span><br/><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;string[] &amp; Array&lt;&#39;Peter&#39; | &#39;Paul&#39;&gt;&gt;</span>
</code></pre>

<a href="#intersecting-objects" id="intersecting-objects" style="color: inherit; text-decoration: none;">
  <h3>Intersecting objects</h3>
</a>
<p>When working with objects, <a href="#extending-objects">extend objects</a> instead of intersecting them whenever possible, since
object shapes are more performant than object intersection shapes.</p>
<p>There&#39;s a logical difference between extended and intersected objects. Let&#39;s consider two shapes that both contain the
same key:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">boolean</span><span class="hl-0">(),</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape2</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-8">// 🟡 Notice that the type of foo property in shape2 differs from shape1.</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span>
</code></pre>
<p>When you <a href="#extending-objects">extend an object</a> properties of the left object are overwritten with properties of the
right object:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">extend</span><span class="hl-0">(</span><span class="hl-4">shape2</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: number, bar: boolean }&gt;</span>
</code></pre>
<p>The intersection requires the input value to conform both shapes at the same time, it&#39;s no possible since there are no
values that can satisfy the <code>string | number</code> type. So the type of property <code>foo</code> becomes <code>never</code> and no value would be
able to satisfy the resulting intersection shape.</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">and</span><span class="hl-0">([</span><span class="hl-4">shape1</span><span class="hl-0">, </span><span class="hl-4">shape2</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: never, bar: boolean }&gt;</span>
</code></pre>

<a href="#json" id="json" style="color: inherit; text-decoration: none;">
  <h2><code>json</code></h2>
</a>
<p>Parses input strings as JSON:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">json</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;string, any&gt;</span>
</code></pre>
<p>Works best with <a href="#shape-piping">shape piping</a>:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">json</span><span class="hl-0">().</span><span class="hl-6">to</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">    </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">  })</span><br/><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;string, { foo: number }&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-1">&#39;{&quot;foo&quot;:42}&#39;</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ { foo: 42 }</span>
</code></pre>

<a href="#lazy" id="lazy" style="color: inherit; text-decoration: none;">
  <h2><code>lazy</code></h2>
</a>
<p>With <code>lazy</code> you can declare recursive shapes. To showcase how to use it, let&#39;s create a shape that validates JSON data:</p>
<pre><code class="language-ts"><span class="hl-3">type</span><span class="hl-0"> </span><span class="hl-9">Json</span><span class="hl-0"> =</span><br/><span class="hl-0">  | </span><span class="hl-9">number</span><br/><span class="hl-0">  | </span><span class="hl-9">string</span><br/><span class="hl-0">  | </span><span class="hl-9">boolean</span><br/><span class="hl-0">  | </span><span class="hl-9">null</span><br/><span class="hl-0">  | </span><span class="hl-9">Json</span><span class="hl-0">[]</span><br/><span class="hl-0">  | { [</span><span class="hl-4">key</span><span class="hl-0">: </span><span class="hl-9">string</span><span class="hl-0">]: </span><span class="hl-9">Json</span><span class="hl-0"> };</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">jsonShape</span><span class="hl-0">: </span><span class="hl-9">d</span><span class="hl-0">.</span><span class="hl-9">Shape</span><span class="hl-0">&lt;</span><span class="hl-9">Json</span><span class="hl-0">&gt; = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">lazy</span><span class="hl-0">(() </span><span class="hl-3">=&gt;</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><br/><span class="hl-0">    </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">(),</span><br/><span class="hl-0">    </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">    </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">boolean</span><span class="hl-0">(),</span><br/><span class="hl-0">    </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">null</span><span class="hl-0">(),</span><br/><span class="hl-0">    </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">array</span><span class="hl-0">(</span><span class="hl-4">jsonShape</span><span class="hl-0">),</span><br/><span class="hl-0">    </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">record</span><span class="hl-0">(</span><span class="hl-4">jsonShape</span><span class="hl-0">)</span><br/><span class="hl-0">  ])</span><br/><span class="hl-0">);</span><br/><br/><span class="hl-4">jsonShape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({ </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-1">&#39;Jill&#39;</span><span class="hl-0"> });</span><br/><span class="hl-8">// ⮕ { name: &#39;Jill&#39; }</span><br/><br/><span class="hl-4">jsonShape</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({ </span><span class="hl-4">tag:</span><span class="hl-0"> </span><span class="hl-6">Symbol</span><span class="hl-0">() });</span><br/><span class="hl-8">// ❌ ValidationError: intersection at /tag: Must conform the intersection</span>
</code></pre>
<p>Note that the <code>Json</code> type is defined explicitly, because it cannot be inferred from the shape which references itself
directly in its own initializer.</p>
<blockquote>
<p><strong>Warning</strong>&ensp;While Doubter supports cyclic types, it doesn&#39;t support cyclic data structures. The latter would
cause an infinite loop at runtime.</p>
</blockquote>

<a href="#map" id="map" style="color: inherit; text-decoration: none;">
  <h2><code>map</code></h2>
</a>
<p>Constrains an input to be a <code>Map</code> instance:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">map</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">());</span><br/><span class="hl-8">// ⮕ Shape&lt;Map&lt;string, number&gt;&gt;</span>
</code></pre>

<a href="#nan" id="nan" style="color: inherit; text-decoration: none;">
  <h2><code>nan</code></h2>
</a>
<p>A shape that requires an input to be equal to <code>NaN</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">nan</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span>
</code></pre>
<p>If you want to constrain a number and allow <code>NaN</code> values, use <a href="#number"><code>number</code></a>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">nan</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span>
</code></pre>

<a href="#never" id="never" style="color: inherit; text-decoration: none;">
  <h2><code>never</code></h2>
</a>
<p>A shape that always raises a validation issue regardless of an input value:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">never</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;never&gt;</span>
</code></pre>

<a href="#null" id="null" style="color: inherit; text-decoration: none;">
  <h2><code>null</code></h2>
</a>
<p>A shape that requires an input to be <code>null</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">null</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;null&gt;</span>
</code></pre>

<a href="#number" id="number" style="color: inherit; text-decoration: none;">
  <h2><code>number</code></h2>
</a>
<p>A shape that requires an input to be a number.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span>
</code></pre>
<p>Allow <code>NaN</code> input values:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">nan</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span>
</code></pre>
<p>Replace <code>NaN</code> with a default value:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">nan</span><span class="hl-0">(</span><span class="hl-7">0</span><span class="hl-0">).</span><span class="hl-6">parse</span><span class="hl-0">(</span><span class="hl-3">NaN</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ 0</span>
</code></pre>
<p>Limit the allowed range:</p>
<pre><code class="language-ts"><span class="hl-8">// The number must be greater than 5 and less then of equal to 10</span><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">gt</span><span class="hl-0">(</span><span class="hl-7">0.5</span><span class="hl-0">).</span><span class="hl-6">lte</span><span class="hl-0">(</span><span class="hl-7">2.5</span><span class="hl-0">)</span><br/><span class="hl-8">// ⮕ Shape&lt;number&gt;</span>
</code></pre>
<p>Constrain a number to be a multiple of a divisor:</p>
<pre><code class="language-ts"><span class="hl-8">// Number must be divisible by 5 without a remainder</span><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">multipleOf</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">);</span>
</code></pre>
<p>Constrain the number to be an integer:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">integer</span><span class="hl-0">();</span><br/><span class="hl-8">// or</span><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">int</span><span class="hl-0">();</span>
</code></pre>
<p>Constrain the number to be a finite to raise an issue if an input value is <code>Infinity</code> or <code>-Infinity</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">finite</span><span class="hl-0">();</span>
</code></pre>
<p>Constrain the number to be an integer:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">integer</span><span class="hl-0">();</span><br/><span class="hl-8">// or</span><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">int</span><span class="hl-0">();</span>
</code></pre>
<p>The finite and integer assertions are always <em>applied before other checks</em>.</p>

<a href="#object" id="object" style="color: inherit; text-decoration: none;">
  <h2><code>object</code></h2>
</a>
<p>Constrains a value to be an object with a set of properties:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ name: string, age: number }&gt;</span>
</code></pre>

<a href="#optional-properties" id="optional-properties" style="color: inherit; text-decoration: none;">
  <h3>Optional properties</h3>
</a>
<p>If the inferred type of the property shape is a union with <code>undefined</code> then the property becomes optional:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">optional</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ name?: string | undefined, age: number }&gt;</span>
</code></pre>
<p>Or you can define optional properties as a union:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">undefined</span><span class="hl-0">()]),</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ name?: string | undefined }&gt;</span>
</code></pre>
<p>If the transformation result extends <code>undefined</code> then the output property becomes optional:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">transform</span><span class="hl-0">(</span><br/><span class="hl-0">    </span><span class="hl-4">value</span><span class="hl-0"> </span><span class="hl-3">=&gt;</span><span class="hl-0"> </span><span class="hl-4">value</span><span class="hl-0"> !== </span><span class="hl-1">&#39;Google&#39;</span><span class="hl-0"> ? </span><span class="hl-4">value</span><span class="hl-0"> : </span><span class="hl-3">undefined</span><br/><span class="hl-0">  ),</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ name: string }, { name?: string | undefined }&gt;</span>
</code></pre>

<a href="#index-signature" id="index-signature" style="color: inherit; text-decoration: none;">
  <h3>Index signature</h3>
</a>
<p>Add an index signature to the object type, so all properties that aren&#39;t listed explicitly are validated with the rest
shape:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: string, bar: number }&gt;</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">restShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;string | number&gt;</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">rest</span><span class="hl-0">(</span><span class="hl-4">restShape</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: string, bar: number, [key: string]: string | number }&gt;</span>
</code></pre>
<p>Unlike an index signature in TypeScript, a rest shape is applied only to keys that aren&#39;t explicitly specified among
object property shapes.</p>

<a href="#unknown-keys" id="unknown-keys" style="color: inherit; text-decoration: none;">
  <h3>Unknown keys</h3>
</a>
<p>Keys that aren&#39;t defined explicitly can be handled in several ways:</p>
<ul>
<li>constrained by the <a href="#index-signature">rest shape</a>;</li>
<li>stripped;</li>
<li>preserved as is, this is the default behavior;</li>
<li>prohibited.</li>
</ul>
<p>Force an object to have only known keys. If an unknown key is met, a validation issue is raised.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">}).</span><span class="hl-6">exact</span><span class="hl-0">();</span>
</code></pre>
<p>Strip unknown keys, so the object is cloned if an unknown key is met, and only known keys are preserved.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">}).</span><span class="hl-6">strip</span><span class="hl-0">();</span>
</code></pre>
<p>Derive the new shape and override the strategy for unknown keys:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({ </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">() }).</span><span class="hl-6">exact</span><span class="hl-0">();</span><br/><br/><span class="hl-8">// Unknonwn keys are now preserved</span><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">preserve</span><span class="hl-0">();</span>
</code></pre>

<a href="#picking-and-omitting-properties" id="picking-and-omitting-properties" style="color: inherit; text-decoration: none;">
  <h3>Picking and omitting properties</h3>
</a>
<p>Picking keys from an object creates the new shape that contains only listed keys:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape2</span><span class="hl-0"> = </span><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">pick</span><span class="hl-0">([</span><span class="hl-1">&#39;foo&#39;</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: string }&gt;</span>
</code></pre>
<p>Omitting keys of an object creates the new shape that contains all keys except listed ones:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">omit</span><span class="hl-0">([</span><span class="hl-1">&#39;foo&#39;</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;{ bar: number }&gt;</span>
</code></pre>

<a href="#extending-objects" id="extending-objects" style="color: inherit; text-decoration: none;">
  <h3>Extending objects</h3>
</a>
<p>Add new properties to the object shape:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">extend</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ name: string, age: number }&gt;</span>
</code></pre>
<p>Merging object shapes preserves the index signature of the left-hand shape:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">fooShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()</span><br/><span class="hl-0">}).</span><span class="hl-6">rest</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()]));</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">barShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-4">fooShape</span><span class="hl-0">.</span><span class="hl-6">extend</span><span class="hl-0">(</span><span class="hl-4">barShape</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: string, bar: number, [key: string]: string | number }&gt;</span>
</code></pre>

<a href="#making-objects-partial-and-required" id="making-objects-partial-and-required" style="color: inherit; text-decoration: none;">
  <h3>Making objects partial and required</h3>
</a>
<p>Object properties are optional if their type extends <code>undefined</code>. Derive an object shape that would have its properties
all marked as optional:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape1</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-4">shape1</span><span class="hl-0">.</span><span class="hl-6">partial</span><span class="hl-0">()</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo?: string | undefined, bar?: number | undefined }&gt;</span>
</code></pre>
<p>Specify which fields should be marked as optional:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape2</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-4">shape2</span><span class="hl-0">.</span><span class="hl-6">partial</span><span class="hl-0">([</span><span class="hl-1">&#39;foo&#39;</span><span class="hl-0">])</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo?: string | undefined, bar: number }&gt;</span>
</code></pre>
<p>In the same way, properties that are optional can be made required:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape3</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">foo:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">optional</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">bar:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-4">shape3</span><span class="hl-0">.</span><span class="hl-6">required</span><span class="hl-0">([</span><span class="hl-1">&#39;foo&#39;</span><span class="hl-0">])</span><br/><span class="hl-8">// ⮕ Shape&lt;{ foo: string, bar: number }&gt;</span>
</code></pre>
<p>Note that <code>required</code> would force the value of both input and output to be non-<code>undefined</code>.</p>

<a href="#object-keys" id="object-keys" style="color: inherit; text-decoration: none;">
  <h3>Object keys</h3>
</a>
<p>Derive a shape that constrains keys of an object:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">keyShape</span><span class="hl-0"> = </span><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">keyof</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;&#39;name&#39; | &#39;age&#39;&gt;</span>
</code></pre>

<a href="#promise" id="promise" style="color: inherit; text-decoration: none;">
  <h2><code>promise</code></h2>
</a>
<p>A shape that constrains to the resolved value of a <code>Promise</code>.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">promise</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">());</span><br/><span class="hl-8">// ⮕ Shape&lt;Promise&lt;string&gt;&gt;</span>
</code></pre>
<p>Transform the value inside a promise:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">promise</span><span class="hl-0">(</span><br/><span class="hl-0">  </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">transform</span><span class="hl-0">(</span><span class="hl-4">parseFloat</span><span class="hl-0">)</span><br/><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;Promise&lt;string&gt;, Promise&lt;number&gt;&gt;</span>
</code></pre>

<a href="#symbol" id="symbol" style="color: inherit; text-decoration: none;">
  <h2><code>symbol</code></h2>
</a>
<p>A shape that constrains a value to be an arbitrary symbol.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">symbol</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;symbol&gt;</span>
</code></pre>
<p>To constrain an input to an exact symbol, use <a href="#const"><code>const</code></a>:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">TAG</span><span class="hl-0"> = </span><span class="hl-6">Symbol</span><span class="hl-0">(</span><span class="hl-1">&#39;tag&#39;</span><span class="hl-0">);</span><br/><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">const</span><span class="hl-0">(</span><span class="hl-5">TAG</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;typeof TAG&gt;</span>
</code></pre>
<p>Or use an <a href="#enum"><code>enum</code></a> to allow several exact symbols:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">FOO</span><span class="hl-0"> = </span><span class="hl-6">Symbol</span><span class="hl-0">(</span><span class="hl-1">&#39;foo&#39;</span><span class="hl-0">);</span><br/><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">BAR</span><span class="hl-0"> = </span><span class="hl-6">Symbol</span><span class="hl-0">(</span><span class="hl-1">&#39;bar&#39;</span><span class="hl-0">);</span><br/><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">([</span><span class="hl-5">FOO</span><span class="hl-0">, </span><span class="hl-5">BAR</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕  Shape&lt;typeof FOO | typeof BAR&gt;</span>
</code></pre>

<a href="#transform" id="transform" style="color: inherit; text-decoration: none;">
  <h2><code>transform</code></h2>
</a>
<p>Transforms the input value:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">shape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">transform</span><span class="hl-0">(</span><span class="hl-4">parseFloat</span><span class="hl-0">);</span><br/><span class="hl-8">// ⮕ Shape&lt;any, number&gt;</span>
</code></pre>
<p>Use <code>transform</code> in conjunction with <a href="#shape-piping">shape-piping</a>:</p>
<pre><code class="language-ts"><span class="hl-4">shape</span><span class="hl-0">.</span><span class="hl-6">to</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">().</span><span class="hl-6">min</span><span class="hl-0">(</span><span class="hl-7">3</span><span class="hl-0">).</span><span class="hl-6">max</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">));</span>
</code></pre>

<a href="#record" id="record" style="color: inherit; text-decoration: none;">
  <h2><code>record</code></h2>
</a>
<p>Constrain keys and values of a dictionary-like object:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">record</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">())</span><br/><span class="hl-8">// ⮕ Shape&lt;Record&lt;string, number&gt;&gt;</span>
</code></pre>
<p>Constrain both keys and values of a dictionary-like object:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">record</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">())</span><br/><span class="hl-8">// ⮕ Shape&lt;Record&lt;string, number&gt;&gt;</span>
</code></pre>
<p>Pass any shape that extends <code>Shape&lt;string&gt;</code> as a key constraint:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">keyShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">([</span><span class="hl-1">&#39;foo&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;bar&#39;</span><span class="hl-0">]);</span><br/><span class="hl-8">// ⮕ Shape&lt;&#39;foo&#39; | &#39;bar&#39;&gt;</span><br/><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">record</span><span class="hl-0">(</span><span class="hl-4">keyShape</span><span class="hl-0">, </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">());</span><br/><span class="hl-8">// ⮕ Shape&lt;Record&lt;&#39;foo&#39; | &#39;bar&#39;, number&gt;&gt;</span>
</code></pre>

<a href="#set" id="set" style="color: inherit; text-decoration: none;">
  <h2><code>set</code></h2>
</a>
<p>Constrains an input to be a <code>Set</code> instance:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">set</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">());</span><br/><span class="hl-8">// ⮕ Shape&lt;Set&lt;number&gt;&gt;</span>
</code></pre>
<p>Constrain the size of a <code>Set</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">set</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()).</span><span class="hl-6">min</span><span class="hl-0">(</span><span class="hl-7">1</span><span class="hl-0">).</span><span class="hl-6">max</span><span class="hl-0">(</span><span class="hl-7">10</span><span class="hl-0">);</span>
</code></pre>
<p>Limit both minimum and maximum size at the same time:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">set</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">()).</span><span class="hl-6">size</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">);</span>
</code></pre>

<a href="#string" id="string" style="color: inherit; text-decoration: none;">
  <h2><code>string</code></h2>
</a>
<p>Constrains a value to be string.</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;string&gt;</span>
</code></pre>
<p>Constrain the string length limits:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">min</span><span class="hl-0">(</span><span class="hl-7">1</span><span class="hl-0">).</span><span class="hl-6">max</span><span class="hl-0">(</span><span class="hl-7">10</span><span class="hl-0">);</span>
</code></pre>
<p>Limit both minimum and maximum string length at the same time:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">length</span><span class="hl-0">(</span><span class="hl-7">5</span><span class="hl-0">);</span>
</code></pre>
<p>Constrain a string with a regular expression:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">().</span><span class="hl-6">regex</span><span class="hl-0">(</span><span class="hl-11">/foo</span><span class="hl-16">|</span><span class="hl-11">bar/</span><span class="hl-0">);</span>
</code></pre>

<a href="#tuple" id="tuple" style="color: inherit; text-decoration: none;">
  <h2><code>tuple</code></h2>
</a>
<p>Constrains a value to be a tuple where elements at particular positions have concrete types:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">tuple</span><span class="hl-0">([</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()]);</span><br/><span class="hl-8">// ⮕ Shape&lt;[string, number]&gt;</span>
</code></pre>
<p>Specify a rest tuple elements:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">tuple</span><span class="hl-0">([</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()], </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">boolean</span><span class="hl-0">());</span><br/><span class="hl-8">// ⮕ Shape&lt;[string, number, ...boolean]&gt;</span><br/><br/><span class="hl-8">// Or</span><br/><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">tuple</span><span class="hl-0">([</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()]).</span><span class="hl-6">rest</span><span class="hl-0">(</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">boolean</span><span class="hl-0">());</span><br/><span class="hl-8">// ⮕ Shape&lt;[string, number, ...boolean]&gt;</span>
</code></pre>

<a href="#union" id="union" style="color: inherit; text-decoration: none;">
  <h2><code>union</code></h2>
</a>
<p>A constraint that allows a value to be one of the given types:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">union</span><span class="hl-0">([</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()]);</span><br/><span class="hl-8">// ⮕ Shape&lt;string | number&gt;</span>
</code></pre>
<p>Use a shorter alias <code>or</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(), </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">number</span><span class="hl-0">()]);</span>
</code></pre>

<a href="#discriminated-unions" id="discriminated-unions" style="color: inherit; text-decoration: none;">
  <h3>Discriminated unions</h3>
</a>
<p>A discriminated union is a union of object shapes that all share a particular key.</p>
<p>Doubter automatically applies various performance optimizations to union shapes and
<a href="https://www.typescriptlang.org/docs/handbook/unions-and-intersections.html#discriminating-unions">discriminated union</a>
detection is one of them. As an example, let&#39;s create a discriminated union of objects representing various business
types.</p>
<p>Sole entrepreneur goes first:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">soleShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">bisinessType:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">const</span><span class="hl-0">(</span><span class="hl-1">&#39;sole&#39;</span><span class="hl-0">),</span><br/><span class="hl-0">  </span><span class="hl-4">name:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">string</span><span class="hl-0">(),</span><br/><span class="hl-0">  </span><span class="hl-4">age:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">int</span><span class="hl-0">().</span><span class="hl-6">gte</span><span class="hl-0">(</span><span class="hl-7">18</span><span class="hl-0">)</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ type: &#39;sole&#39;, name: string, age: number }&gt;</span>
</code></pre>
<p>We&#39;re going to use <code>bisinessType</code> property as the discriminator in our union. Now let&#39;s define a shape for a company:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">companyShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">object</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">businessType:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">or</span><span class="hl-0">([</span><br/><span class="hl-0">    </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">const</span><span class="hl-0">(</span><span class="hl-1">&#39;llc&#39;</span><span class="hl-0">),</span><br/><span class="hl-0">    </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">enum</span><span class="hl-0">([</span><span class="hl-1">&#39;corporation&#39;</span><span class="hl-0">, </span><span class="hl-1">&#39;partnership&#39;</span><span class="hl-0">])</span><br/><span class="hl-0">  ]),</span><br/><span class="hl-0">  </span><span class="hl-4">headcount:</span><span class="hl-0"> </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">int</span><span class="hl-0">().</span><span class="hl-6">positive</span><span class="hl-0">()</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ⮕ Shape&lt;{ type: &#39;llc&#39; | &#39;corporation&#39; | &#39;partneership&#39;, headcount: number }&gt;</span>
</code></pre>
<p>Notice that we declared <code>businessType</code> as a composite shape. This would work just fine until shape restricts its input
to a set of literal values.</p>
<p>The final step is to define a discriminated union shape:</p>
<pre><code class="language-ts"><span class="hl-3">const</span><span class="hl-0"> </span><span class="hl-5">businessShape</span><span class="hl-0"> = </span><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">union</span><span class="hl-0">([</span><span class="hl-4">soleShape</span><span class="hl-0">, </span><span class="hl-4">companyShape</span><span class="hl-0">]);</span>
</code></pre>
<p><code>union</code> would detect that all object shapes in the union have the <code>businessType</code> property with distinct values and would
enable a discriminated union optimization.</p>
<p>Discriminated unions raise fewer issues because only one shape from the union can be applied to an input:</p>
<pre><code class="language-ts"><span class="hl-4">businessType</span><span class="hl-0">.</span><span class="hl-6">parse</span><span class="hl-0">({</span><br/><span class="hl-0">  </span><span class="hl-4">businessType:</span><span class="hl-0"> </span><span class="hl-1">&#39;corporation&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-4">headcount:</span><span class="hl-0"> </span><span class="hl-7">0</span><br/><span class="hl-0">});</span><br/><span class="hl-8">// ❌ ValidationError: numberGreaterThan at /headcount: Must be greater than 0</span>
</code></pre>

<a href="#undefined" id="undefined" style="color: inherit; text-decoration: none;">
  <h2><code>undefined</code></h2>
</a>
<p>A shape that requires an input to be <code>undefined</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">undefined</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;undefined&gt;</span>
</code></pre>

<a href="#unknown" id="unknown" style="color: inherit; text-decoration: none;">
  <h2><code>unknown</code></h2>
</a>
<p>An unconstrained value that is inferred as <code>unknown</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">unknown</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;unknown&gt;</span>
</code></pre>

<a href="#void" id="void" style="color: inherit; text-decoration: none;">
  <h2><code>void</code></h2>
</a>
<p>A shape that requires an input to be <code>undefined</code> that is typed as <code>void</code>:</p>
<pre><code class="language-ts"><span class="hl-4">d</span><span class="hl-0">.</span><span class="hl-6">void</span><span class="hl-0">();</span><br/><span class="hl-8">// ⮕ Shape&lt;void&gt;</span>
</code></pre>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">Doubter -<wbr/> v1.2.0</a>
<ul></ul></li></ul></div></details></nav>
<nav class="tsd-navigation secondary menu-sticky">
<ul>
<li class="tsd-kind-reference"><a href="modules.html#and" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><rect fill="var(--color-icon-background)" stroke="#FF4D82" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="12" id="icon-8388608-path"></rect><path d="M10.354 17V8.24H13.066C13.586 8.24 14.042 8.348 14.434 8.564C14.826 8.772 15.13 9.064 15.346 9.44C15.562 9.816 15.67 10.256 15.67 10.76C15.67 11.352 15.514 11.86 15.202 12.284C14.898 12.708 14.482 13 13.954 13.16L15.79 17H14.518L12.838 13.28H11.434V17H10.354ZM11.434 12.308H13.066C13.514 12.308 13.874 12.168 14.146 11.888C14.418 11.6 14.554 11.224 14.554 10.76C14.554 10.288 14.418 9.912 14.146 9.632C13.874 9.352 13.514 9.212 13.066 9.212H11.434V12.308Z" fill="var(--color-text)" id="icon-8388608-text"></path></svg>and</a></li>
<li class="tsd-kind-reference"><a href="modules.html#bool" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-8388608-path"></use><use href="#icon-8388608-text"></use></svg>bool</a></li>
<li class="tsd-kind-reference"><a href="modules.html#int" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-8388608-path"></use><use href="#icon-8388608-text"></use></svg>int</a></li>
<li class="tsd-kind-reference"><a href="modules.html#or" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-8388608-path"></use><use href="#icon-8388608-text"></use></svg>or</a></li>
<li class="tsd-kind-class"><a href="classes/ArrayShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-class)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6" id="icon-128-path"></rect><path d="M11.898 16.1201C11.098 16.1201 10.466 15.8961 10.002 15.4481C9.53803 15.0001 9.30603 14.3841 9.30603 13.6001V9.64012C9.30603 8.85612 9.53803 8.24012 10.002 7.79212C10.466 7.34412 11.098 7.12012 11.898 7.12012C12.682 7.12012 13.306 7.34812 13.77 7.80412C14.234 8.25212 14.466 8.86412 14.466 9.64012H13.386C13.386 9.14412 13.254 8.76412 12.99 8.50012C12.734 8.22812 12.37 8.09212 11.898 8.09212C11.426 8.09212 11.054 8.22412 10.782 8.48812C10.518 8.75212 10.386 9.13212 10.386 9.62812V13.6001C10.386 14.0961 10.518 14.4801 10.782 14.7521C11.054 15.0161 11.426 15.1481 11.898 15.1481C12.37 15.1481 12.734 15.0161 12.99 14.7521C13.254 14.4801 13.386 14.0961 13.386 13.6001H14.466C14.466 14.3761 14.234 14.9921 13.77 15.4481C13.306 15.8961 12.682 16.1201 11.898 16.1201Z" fill="var(--color-text)" id="icon-128-text"></path></svg>Array<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/BigIntShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Big<wbr/>Int<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/BooleanShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Boolean<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/CatchShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Catch<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/CoercibleShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Coercible<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/ConstShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Const<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/DateShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Date<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/EnumShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Enum<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/ExcludeShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Exclude<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/InstanceShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Instance<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/IntersectionShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Intersection<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/JSONShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>JSONShape</a></li>
<li class="tsd-kind-class"><a href="classes/LazyShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Lazy<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/MapShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Map<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/NeverShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Never<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/NumberShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Number<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/ObjectShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Object<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/PipeShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Pipe<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/PromiseShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Promise<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/RecordShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Record<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/ReplaceShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Replace<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/SetShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Set<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/Shape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/StringShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>String<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/SymbolShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Symbol<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/TransformShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Transform<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/UnionShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Union<wbr/>Shape</a></li>
<li class="tsd-kind-class"><a href="classes/ValidationError.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-128-path"></use><use href="#icon-128-text"></use></svg>Validation<wbr/>Error</a></li>
<li class="tsd-kind-interface"><a href="interfaces/Check.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-interface)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6" id="icon-256-path"></rect><path d="M9.51 16V15.016H11.298V8.224H9.51V7.24H14.19V8.224H12.402V15.016H14.19V16H9.51Z" fill="var(--color-text)" id="icon-256-text"></path></svg>Check</a></li>
<li class="tsd-kind-interface"><a href="interfaces/CheckOptions.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-256-path"></use><use href="#icon-256-text"></use></svg>Check<wbr/>Options</a></li>
<li class="tsd-kind-interface"><a href="interfaces/ConstraintOptions.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-256-path"></use><use href="#icon-256-text"></use></svg>Constraint<wbr/>Options</a></li>
<li class="tsd-kind-interface"><a href="interfaces/DeepPartialProtocol.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-256-path"></use><use href="#icon-256-text"></use></svg>Deep<wbr/>Partial<wbr/>Protocol</a></li>
<li class="tsd-kind-interface"><a href="interfaces/Err.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-256-path"></use><use href="#icon-256-text"></use></svg>Err</a></li>
<li class="tsd-kind-interface"><a href="interfaces/IncludeShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-256-path"></use><use href="#icon-256-text"></use></svg>Include<wbr/>Shape</a></li>
<li class="tsd-kind-interface"><a href="interfaces/Issue.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-256-path"></use><use href="#icon-256-text"></use></svg>Issue</a></li>
<li class="tsd-kind-interface"><a href="interfaces/Ok.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-256-path"></use><use href="#icon-256-text"></use></svg>Ok</a></li>
<li class="tsd-kind-interface"><a href="interfaces/ParseOptions.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-256-path"></use><use href="#icon-256-text"></use></svg>Parse<wbr/>Options</a></li>
<li class="tsd-kind-interface"><a href="interfaces/RefineOptions.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-256-path"></use><use href="#icon-256-text"></use></svg>Refine<wbr/>Options</a></li>
<li class="tsd-kind-type-alias"><a href="types/AnyShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><rect fill="var(--color-icon-background)" stroke="var(--color-ts)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6" id="icon-4194304-path"></rect><path d="M11.31 16V8.224H8.91V7.24H14.79V8.224H12.39V16H11.31Z" fill="var(--color-text)" id="icon-4194304-text"></path></svg>Any<wbr/>Shape</a></li>
<li class="tsd-kind-type-alias"><a href="types/BrandShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4194304-path"></use><use href="#icon-4194304-text"></use></svg>Brand<wbr/>Shape</a></li>
<li class="tsd-kind-type-alias"><a href="types/CheckCallback.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4194304-path"></use><use href="#icon-4194304-text"></use></svg>Check<wbr/>Callback</a></li>
<li class="tsd-kind-type-alias"><a href="types/DeepPartialShape.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4194304-path"></use><use href="#icon-4194304-text"></use></svg>Deep<wbr/>Partial<wbr/>Shape</a></li>
<li class="tsd-kind-type-alias"><a href="types/KeysMode.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4194304-path"></use><use href="#icon-4194304-text"></use></svg>Keys<wbr/>Mode</a></li>
<li class="tsd-kind-type-alias"><a href="types/Literal.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4194304-path"></use><use href="#icon-4194304-text"></use></svg>Literal</a></li>
<li class="tsd-kind-type-alias"><a href="types/Message.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4194304-path"></use><use href="#icon-4194304-text"></use></svg>Message</a></li>
<li class="tsd-kind-type-alias"><a href="types/MessageCallback.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4194304-path"></use><use href="#icon-4194304-text"></use></svg>Message<wbr/>Callback</a></li>
<li class="tsd-kind-type-alias"><a href="types/ValueType.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-4194304-path"></use><use href="#icon-4194304-text"></use></svg>Value<wbr/>Type</a></li>
<li class="tsd-kind-function"><a href="functions/any.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-function)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6" id="icon-64-path"></rect><path d="M9.39 16V7.24H14.55V8.224H10.446V11.128H14.238V12.112H10.47V16H9.39Z" fill="var(--color-text)" id="icon-64-text"></path></svg>any</a></li>
<li class="tsd-kind-function"><a href="functions/array.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>array</a></li>
<li class="tsd-kind-function"><a href="functions/bigint.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>bigint</a></li>
<li class="tsd-kind-function"><a href="functions/boolean.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>boolean</a></li>
<li class="tsd-kind-function"><a href="functions/const.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>const</a></li>
<li class="tsd-kind-function"><a href="functions/date.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>date</a></li>
<li class="tsd-kind-function"><a href="functions/enum.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>enum</a></li>
<li class="tsd-kind-function"><a href="functions/finite.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>finite</a></li>
<li class="tsd-kind-function"><a href="functions/guard.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>guard</a></li>
<li class="tsd-kind-function"><a href="functions/guardAsync.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>guard<wbr/>Async</a></li>
<li class="tsd-kind-function"><a href="functions/instanceOf.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>instance<wbr/>Of</a></li>
<li class="tsd-kind-function"><a href="functions/integer.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>integer</a></li>
<li class="tsd-kind-function"><a href="functions/intersection.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>intersection</a></li>
<li class="tsd-kind-function"><a href="functions/json.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>json</a></li>
<li class="tsd-kind-function"><a href="functions/lazy.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>lazy</a></li>
<li class="tsd-kind-function"><a href="functions/map.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>map</a></li>
<li class="tsd-kind-function"><a href="functions/nan.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>nan</a></li>
<li class="tsd-kind-function"><a href="functions/never.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>never</a></li>
<li class="tsd-kind-function"><a href="functions/null.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>null</a></li>
<li class="tsd-kind-function"><a href="functions/number.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>number</a></li>
<li class="tsd-kind-function"><a href="functions/object.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>object</a></li>
<li class="tsd-kind-function"><a href="functions/promise.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>promise</a></li>
<li class="tsd-kind-function"><a href="functions/record.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>record</a></li>
<li class="tsd-kind-function"><a href="functions/set.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>set</a></li>
<li class="tsd-kind-function"><a href="functions/string.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>string</a></li>
<li class="tsd-kind-function"><a href="functions/symbol.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>symbol</a></li>
<li class="tsd-kind-function"><a href="functions/transform.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>transform</a></li>
<li class="tsd-kind-function"><a href="functions/transformAsync.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>transform<wbr/>Async</a></li>
<li class="tsd-kind-function"><a href="functions/tuple.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>tuple</a></li>
<li class="tsd-kind-function"><a href="functions/undefined.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>undefined</a></li>
<li class="tsd-kind-function"><a href="functions/union.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>union</a></li>
<li class="tsd-kind-function"><a href="functions/unknown.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>unknown</a></li>
<li class="tsd-kind-function"><a href="functions/void.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><use href="#icon-64-path"></use><use href="#icon-64-text"></use></svg>void</a></li></ul></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>